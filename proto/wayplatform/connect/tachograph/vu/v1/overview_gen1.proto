edition = "2023";

package wayplatform.connect.tachograph.vu.v1;

// Represents the data structure for an OverviewGen1 transfer.
// See Appendix 7, Section 2.2.6.2.
message OverviewGen1 {

  message VehicleRegistration {
    // See Appendix 1, 2.166 & 2.101
    uint32 nation = 1;
    // See Appendix 1, 2.167
    string number = 2;
  }

  message DownloadablePeriod {
    // See Appendix 1, 2.193. Earliest downloadable date.
    // Represented as seconds since 1970-01-01 00:00:00 UTC (TimeReal).
    uint32 min_time = 1;
    // See Appendix 1, 2.193. Latest downloadable date.
    // Represented as seconds since 1970-01-01 00:00:00 UTC (TimeReal).
    uint32 max_time = 2;
  }

  enum SlotCardType {
    // See Appendix 1, 2.34
    SLOT_CARD_TYPE_UNSPECIFIED = 0;
    NO_CARD = 1;
    DRIVER_CARD = 2;
    WORKSHOP_CARD = 3;
    CONTROL_CARD = 4;
    COMPANY_CARD = 5;
  }

  message CompanyLock {
    // See Appendix 1, 2.184
    uint32 lock_in_time = 1;
    uint32 lock_out_time = 2;
    string company_name = 3;
    string company_address = 4;
    // See Appendix 1, 2.73. This is a complex type, using string for now.
    string company_card_number = 5;
  }

  message ControlActivity {
    // See Appendix 1, 2.187
    // Bitfield defined in Appendix 1, 2.53
    bytes control_type = 1;
    uint32 control_time = 2;
    // See Appendix 1, 2.73. This is a complex type, using string for now.
    string control_card_number = 3;
    uint32 download_period_begin_time = 4;
    uint32 download_period_end_time = 5;
  }

  // See Appendix 1, 2.96 & 2.41. 194 bytes.
  bytes member_state_certificate = 1;

  // See Appendix 1, 2.181 & 2.41. 194 bytes.
  bytes vu_certificate = 2;

  // See Appendix 1, 2.164.
  string vehicle_identification_number = 3;

  VehicleRegistration vehicle_registration = 4;

  // See Appendix 1, 2.54 & 2.162. Seconds since 1970-01-01.
  uint32 current_date_time = 5;

  DownloadablePeriod downloadable_period = 6;

  SlotCardType driver_slot_card = 7;
  SlotCardType co_driver_slot_card = 8;

  // See Appendix 1, 2.195. Last download time. Seconds since 1970-01-01.
  uint32 last_download_time = 9;

  repeated CompanyLock company_locks = 10;

  repeated ControlActivity control_activities = 11;

  // See Appendix 1, 2.149. 128 bytes.
  bytes signature = 12;
}