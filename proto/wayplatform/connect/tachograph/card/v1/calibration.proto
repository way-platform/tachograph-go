edition = "2023";

package wayplatform.connect.tachograph.card.v1;

import "google/protobuf/timestamp.proto";
import "wayplatform/connect/tachograph/datadictionary/v1/calibration_purpose.proto";
import "wayplatform/connect/tachograph/datadictionary/v1/extended_serial_number.proto";
import "wayplatform/connect/tachograph/datadictionary/v1/vehicle_registration_identification.proto";

// Represents the content of the EF_Calibration file.
//
// The file structure is specified in Appendix 2, Section 4.3.1.
//
//     EF Calibration
//     └─WorkshopCardCalibrationData
//
// The data type `WorkshopCardCalibrationData` is specified in the Data Dictionary, Section 2.235.
//
// ASN.1 Specification:
//
//     WorkshopCardCalibrationData ::= SEQUENCE {
//         calibrationTotalNumber INTEGER(0..NoOfCalibrationRecords),
//         calibrationPointerNewestRecord INTEGER(0..NoOfCalibrationRecords-1),
//         calibrationRecords SET SIZE(NoOfCalibrationRecords) OF WorkshopCardCalibrationRecord
//     }
message Calibration {
  // Represents a single calibration record.
  //
  // The data type `WorkshopCardCalibrationRecord` is specified in the Data Dictionary, Section 2.236.
  //
  // ASN.1 Specification:
  //
  //     WorkshopCardCalibrationRecord ::= SEQUENCE {
  //         calibrationPurpose CalibrationPurpose,
  //         vehicleIdentificationNumber VehicleIdentificationNumber,
  //         vehicleRegistration VehicleRegistrationIdentification,
  //         wVehicleCharacteristicConstant W-VehicleCharacteristicConstant,
  //         kConstantOfRecordingEquipment K-ConstantOfRecordingEquipment,
  //         lTyreCircumference L-TyreCircumference,
  //         tyreSize TyreSize,
  //         authorisedSpeed SpeedAuthorised,
  //         oldOdometerValue OdometerShort,
  //         newOdometerValue OdometerShort,
  //         oldTimeValue TimeReal,
  //         newTimeValue TimeReal,
  //         nextCalibrationDate TimeReal,
  //         vuPartNumber VuPartNumber,
  //         vuSerialNumber ExtendedSerialNumber,
  //         sensorSerialNumber SensorSerialNumber
  //     }
  message Record {
    // The purpose of the calibration.
    //
    // ASN.1 Specification:
    //
    //     CalibrationPurpose ::= OCTET STRING (SIZE(1))
    datadictionary.v1.CalibrationPurpose calibration_purpose = 1;
    

    // The Vehicle Identification Number.
    //
    // ASN.1 Specification:
    //
    //     VehicleIdentificationNumber ::= IA5String(SIZE(17))
    string vehicle_identification_number = 3;

    // The vehicle registration identifier.
    //
    // ASN.1 Specification:
    //
    //     VehicleRegistrationIdentification ::= SEQUENCE { ... }
    datadictionary.v1.VehicleRegistrationIdentification vehicle_registration = 4;

    // The vehicle characteristic constant.
    //
    // ASN.1 Specification:
    //
    //     W-VehicleCharacteristicConstant ::= INTEGER(0..65535)
    int32 w_vehicle_characteristic_constant = 5;

    // The constant of the recording equipment.
    //
    // ASN.1 Specification:
    //
    //     K-ConstantOfRecordingEquipment ::= INTEGER(0..65535)
    int32 k_constant_of_recording_equipment = 6;

    // The tyre circumference in mm.
    //
    // ASN.1 Specification:
    //
    //     L-TyreCircumference ::= INTEGER(0..65535)
    int32 l_tyre_circumference_mm = 7;

    // The tyre size designation.
    //
    // ASN.1 Specification:
    //
    //     TyreSize ::= IA5String(SIZE(15))
    string tyre_size = 8;

    // The authorised speed in km/h.
    //
    // ASN.1 Specification:
    //
    //     SpeedAuthorised ::= INTEGER(0..255)
    int32 authorised_speed_kmh = 9;

    // The odometer value before calibration in km.
    //
    // ASN.1 Specification:
    //
    //     OdometerShort ::= INTEGER(0..999999)
    int32 old_odometer_km = 10;

    // The odometer value after calibration in km.
    //
    // ASN.1 Specification:
    //
    //     OdometerShort ::= INTEGER(0..999999)
    int32 new_odometer_km = 11;

    // The time value before calibration.
    //
    // ASN.1 Specification:
    //
    //     TimeReal ::= INTEGER (0..2^32-1)
    google.protobuf.Timestamp old_time = 12;

    // The time value after calibration.
    //
    // ASN.1 Specification:
    //
    //     TimeReal ::= INTEGER (0..2^32-1)
    google.protobuf.Timestamp new_time = 13;

    // The date of the next calibration.
    //
    // ASN.1 Specification:
    //
    //     TimeReal ::= INTEGER (0..2^32-1)
    google.protobuf.Timestamp next_calibration_date = 14;

    // The part number of the Vehicle Unit.
    //
    // ASN.1 Specification:
    //
    //     VuPartNumber ::= IA5String(SIZE(16))
    string vu_part_number = 15;

    // The serial number of the Vehicle Unit.
    //
    // ASN.1 Specification:
    //
    //     ExtendedSerialNumber ::= SEQUENCE { ... }
    datadictionary.v1.ExtendedSerialNumber vu_serial_number = 16;

    // The serial number of the motion sensor.
    //
    // ASN.1 Specification:
    //
    //     SensorSerialNumber ::= ExtendedSerialNumber
    datadictionary.v1.ExtendedSerialNumber sensor_serial_number = 17;
  }

  // Total number of calibrations performed with the card.
  int32 calibration_total_count = 1;

  // Index of the last updated record.
  int32 newest_record_index = 2;

  // The set of calibration records.
  repeated Record records = 3;
}