edition = "2023";

package wayplatform.connect.tachograph.card.v1;

import "wayplatform/connect/tachograph/dd/v1/ia5_string_value.proto";
import "wayplatform/connect/tachograph/dd/v1/nation_numeric.proto";
import "wayplatform/connect/tachograph/dd/v1/string_value.proto";

// Represents the content of the EF_Driving_Licence_Info file, which contains the
// card holder's driving licence information.
//
// The file structure is defined in Appendix 2 (tables TCS_150 and TCS_154) and
// does not contain a signature block.
//
// File Structure (from TCS_154):
//
//     EF Driving_Licence_Info
//     └─CardDrivingLicenceInformation
//
// The data type `CardDrivingLicenceInformation` is specified in the Data Dictionary, Section 2.18.
//
// ASN.1 Specification:
//
//     CardDrivingLicenceInformation ::= SEQUENCE {
//         drivingLicenceIssuingAuthority Name,
//         drivingLicenceIssuingNation NationNumeric,
//         drivingLicenceNumber IA5String(SIZE(16))
//     }
message DrivingLicenceInfo {
  // Authority that issued the driving licence.
  //
  // See Data Dictionary, Section 2.99, `Name`.
  // ASN.1 Specification:
  //
  //     Name ::= SEQUENCE { codePage INTEGER(0..255), name OCTET STRING (SIZE(36)) }
  wayplatform.connect.tachograph.dd.v1.StringValue driving_licence_issuing_authority = 1;

  // Nation of the issuing authority.
  //
  // See Data Dictionary, Section 2.101, `NationNumeric`.
  // ASN.1 Specification:
  //
  //     NationNumeric ::= INTEGER(0..255)
  wayplatform.connect.tachograph.dd.v1.NationNumeric driving_licence_issuing_nation = 2;

  // The driving licence number.
  //
  // See Data Dictionary, Section 2.18, `drivingLicenceNumber`.
  // ASN.1 Specification:
  //
  //     IA5String(SIZE(16))
  wayplatform.connect.tachograph.dd.v1.Ia5StringValue driving_licence_number = 3;

  // Signature data from the following file block, if tagged as a signature for
  // this EF according to the card file format specification (Appendix 2).
  //
  // See Data Dictionary, Section 2.149, `Signature`.
  //
  // ASN.1 Definition (Gen1):
  //
  //     Signature ::= OCTET STRING (SIZE(128))
  //
  // ASN.1 Definition (Gen2):
  //
  //     Signature ::= OCTET STRING (variable size, depends on elliptic curve)
  //
  // Gen2 uses ECDSA signatures with variable lengths based on the curve:
  // - 256-bit curves: ~64 bytes
  // - 384-bit curves: ~96 bytes
  // - 512/521-bit curves: ~128-132 bytes
  bytes signature = 4;

  // Indicates if the signature has been successfully verified.
  bool signature_verified = 5;
}
