edition = "2023";

package wayplatform.connect.tachograph.card.v1;

import "wayplatform/connect/tachograph/dd/v1/specific_condition_record.proto";

// Represents the content of the EF_Specific_Conditions file for Generation 1.
//
// Gen1 uses a fixed-size array of 56 records with no circular buffer pointer.
// This provides 280 bytes total storage (56 records × 5 bytes each).
//
// Gen1: Fixed 56 records, no pointer.
//
// The file structure is specified in Appendix 2, Section 4.2.1 (TCS_150):
//
//     EF Specific_Conditions
//     └─SpecificConditions
//
// The data type `SpecificConditions` is specified in the Data Dictionary, Section 2.153.
//
// ASN.1 Definition (Gen1):
//
//     SpecificConditions ::= SET SIZE(56) OF SpecificConditionRecord
//
message SpecificConditions {
  // The fixed array of 56 specific condition records.
  //
  // Each record is 5 bytes (entryTime + specificConditionType).
  //
  // See Data Dictionary, Section 2.152, `SpecificConditionRecord`.
  repeated dd.v1.SpecificConditionRecord records = 1;

  // Complete raw binary data (all 56 records).
  //
  // Used as canvas for raw data painting during marshalling to preserve
  // unknown bits and ensure perfect round-trip fidelity.
  //
  // Length: 56 records × 5 bytes = 280 bytes (fixed)
  bytes raw_data = 2;

  // Signature data from the following file block, if tagged as a signature for
  // this EF according to the card file format specification (Appendix 2).
  //
  // See Data Dictionary, Section 2.149, `Signature`.
  //
  // ASN.1 Definition (Gen1):
  //
  //     Signature ::= OCTET STRING (SIZE(128))
  //
  // ASN.1 Definition (Gen2):
  //
  //     Signature ::= OCTET STRING (variable size, depends on elliptic curve)
  //
  // Gen2 uses ECDSA signatures with variable lengths based on the curve:
  // - 256-bit curves: ~64 bytes
  // - 384-bit curves: ~96 bytes
  // - 512/521-bit curves: ~128-132 bytes
  bytes signature = 3;

  // Indicates if the signature has been successfully verified.
  bool signature_verified = 4;
}
