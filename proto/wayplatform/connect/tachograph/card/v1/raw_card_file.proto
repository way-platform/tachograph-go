edition = "2023";

package wayplatform.connect.tachograph.card.v1;

import "wayplatform/connect/tachograph/card/v1/content_type.proto";
import "wayplatform/connect/tachograph/card/v1/elementary_file_type.proto";
import "wayplatform/connect/tachograph/dd/v1/generation.proto";

// Represents the low-level structure of a downloaded card file, containing a
// sequence of raw Tag-Length-Value (TLV) records. This is the result of the
// first parsing pass and is used as input for the second pass, which interprets
// the `value` bytes into semantic messages.
//
// This message is part of the internal data model and does not correspond to a
// specific data type in the Data Dictionary.
message RawCardFile {
  // A TLV record of the raw card file.
  message Record {
    // The tag of the TLV record, identifying the data type.
    int32 tag = 1;

    // The elementary file type, inferred from the tag.
    ElementaryFileType file = 2;

    // The application generation (Gen1 or Gen2), inferred from the tag.
    //
    // See Data Dictionary, Section 2.75, `Generation`.
    dd.v1.Generation generation = 3;

    // The content type of the value (data or signature), inferred from the tag.
    ContentType content_type = 4;

    // The length of the record's value in bytes.
    int32 length = 5;

    // The raw byte value of the record.
    bytes value = 6;
  }

  // The sequence of TLV records from the downloaded file.
  repeated Record records = 1;
}
