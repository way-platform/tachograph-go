<!DOCTYPE html>
<html>
<head>

      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
      <title>Consolidated TEXT: 32016R0799 — EN — 21.08.2023</title>
      <link type="text/css" rel="stylesheet" href="http://publications.europa.eu/resource/presentation-style-sheet/clg/clg.css"/>
   
</head>
<body>
<p class="title-annex-1" id="id-54e32d3b-40a9-496c-86ea-c9dbe4c457fa">Appendix 2</p>
<p class="title-gr-seq-level-1" id="id-7d4fc687-730d-4649-9310-4569c108104f">
               <span class="boldface">TACHOGRAPH CARDS SPECIFICATION</span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="3">
               <colgroup><col width="15%"/>
               <col width="85%"/>
               </colgroup><tbody><tr>
                  <td colspan="2">
                     <p class="title-toc" id="id-e2b029f5-e62a-479d-87d1-25282d6eb916">TABLE OF CONTENT</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">INTRODUCTION</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">1.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Abbreviations</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">1.2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">References</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">ELECTRICAL AND PHYSICAL CHARACTERISTICS</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">2.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Supply Voltage and Current Consumption</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">2.2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Programming Voltage V<span class="subscript">pp</span>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">2.3.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Clock generation and Frequency</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">2.4.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">I/O Contact</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">2.5.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">States of the Card</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">HARDWARE AND COMMUNICATION</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Introduction</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Transmission Protocol</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.2.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Protocols</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.2.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">ATR</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.2.3</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">PTS</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.3.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Access Rules</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.4.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Commands and error codes overview</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Command descriptions</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">SELECT</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">READ BINARY</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.3</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">UPDATE BINARY</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.4</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">GET CHALLENGE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.5</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">VERIFY</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.6</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">GET RESPONSE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.7</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">PSO: VERIFY CERTIFICATE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.8</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">INTERNAL AUTHENTICATE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.9</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">EXTERNAL AUTHENTICATE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.10</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">GENERAL AUTHENTICATE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.11</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">MANAGE SECURITY ENVIRONMENT</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.12</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">PSO: HASH</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.13</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">PERFORM HASH OF FILE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.14</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">PSO: COMPUTE DIGITAL SIGNATURE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.15</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">PSO: VERIFY DIGITAL SIGNATURE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.5.16</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">PROCESS DSRC MESSAGE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">TACHOGRAPH CARDS STRUCTURE</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Master File MF</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Driver card applications</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Driver card application generation 1</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Driver card application generation 2</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.3.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Workshop card applications</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.3.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Workshop card application generation 1</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.3.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Workshop card application generation 2</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Control card applications</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Control Card application generation 1</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Control card application generation 2</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.5.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Company card applications</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.5.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Company card application generation 1</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.5.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Company card application generation 2</p>
                  </td>
               </tr>
            </tbody></table>
<p class="title-gr-seq-level-2" id="id-90f74b24-6bbe-4332-83b3-fad28f88c026">1.   <span class="boldface">INTRODUCTION</span>
            </p>
<p class="title-gr-seq-level-3" id="id-bdc32976-4264-42aa-ab53-ceb05fa0da23">1.1.   <span class="boldface">
                  <span class="boldface">Abbreviations</span>
               </span>
            </p>
<p class="norm">For the purpose of this appendix, the following abbreviations apply.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">AC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Access conditions</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">AES</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Advanced Encryption Standard</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">AID</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Application Identifier</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ALW</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Always</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">APDU</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Application Protocol Data Unit (structure of a command)</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ATR</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Answer To Reset</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">AUT</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Authenticated.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">C6, C7</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Contacts No 6 and 7 of the card as described in ISO/IEC 7816-2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">cc</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">clock cycles</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: INSERTED">▼M1</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">CHA</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Certificate Holder Authorisation</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">CHV</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Card holder Verification Information</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">CLA</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Class byte of an APDU command</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: INSERTED">▼M1</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">DO</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Data Object</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">DSRC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Dedicated Short Range Communication</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">DF</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Dedicated File. A DF can contain other files (EF or DF)</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ECC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Elliptic Curve Cryptography</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">EF</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Elementary File</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">etu</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">elementary time unit</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">G1</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Generation 1</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">G2</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Generation 2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">IC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Integrated Circuit</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ICC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Integrated Circuit Card</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ID</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Identifier</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">IFD</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Interface Device</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">IFS</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Information Field Size</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">IFSC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Information Field Size for the card</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">IFSD</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Information Field Size Device (for the Terminal)</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">INS</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Instruction byte of an APDU command</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">Lc</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Length of the input data for a APDU command</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">Le</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Length of the expected data (output data for a command)</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">MF</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Master File (root DF)</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">NAD</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Node Address used in T=1 protocol</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">NEV</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Never</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">P1-P2</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Parameter bytes</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">PIN</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Personal Identification Number</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">PRO SM</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Protected with secure messaging</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">PTS</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Protocol Transmission Selection</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">RFU</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Reserved for Future Use</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">RST</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Reset (of the card)</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">SFID</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Short EF Identifier</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">SM</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Secure Messaging</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">SW1-SW2</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Status bytes</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">TS</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Initial ATR character</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">VPP</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Programming Voltage</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">VU</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Vehicle Unit</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">XXh</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Value XX in hexadecimal notation</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">‘XXh’</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Value XX in hexadecimal notation</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">||</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Concatenation symbol 03||04=0304</p>
                  </td>
               </tr>
            </tbody></table>
<p class="title-gr-seq-level-3" id="id-2d4dbf05-b3be-42c7-93a3-7e8e21473ce4">1.2.   <span class="boldface">
                  <span class="boldface">References</span>
               </span>
            </p>
<p class="norm">The following references are used in this Appendix:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ISO/IEC 7816-2</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Identification cards — Integrated circuit cards — Part 2: Dimensions and location of the contacts. ISO/IEC 7816-2:2007.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ISO/IEC 7816-3</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Identification cards — Integrated circuit cards — Part 3: Electrical interface and transmission protocols. ISO/IEC 7816-3:2006.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ISO/IEC 7816-4</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Identification cards — Integrated circuit cards — Part 4: Organization, security and commands for interchange. ISO/IEC 7816-4:2013 + Cor 1: 2014.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ISO/IEC 7816-6</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Identification cards — Integrated circuit cards — Part 6: Interindustry data elements for interchange. ISO/IEC 7816-6:2004 + Cor 1: 2006.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ISO/IEC 7816-8</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Identification cards — Integrated circuit cards — Part 8: Commands for security operations. ISO/IEC 7816-8:2004.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ISO/IEC 9797-2</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Information technology — Security techniques — Message Authentication Codes (MACs) — Part 2: Mechanisms using a dedicated hash-function. ISO/IEC 9797-2:2011</p>
                  </td>
               </tr>
            </tbody></table>
<p class="title-gr-seq-level-2" id="id-f27a484a-0fca-43a0-a11d-ddff3149fa18">2.   <span class="boldface">ELECTRICAL AND PHYSICAL CHARACTERISTICS</span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_01<span style="word-spacing: NaNpt"> </span>All electronic signals shall be in accordance with ISO/IEC 7816-3 unless specified otherwise.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_02<span style="word-spacing: NaNpt"> </span>The location and dimensions of the card contacts shall comply with the ISO/IEC 7816-2.</p>
            </div>
<p class="title-gr-seq-level-3" id="id-6854d34b-aa77-4bc6-8563-e73685451bc1">2.1.   <span class="boldface">
                  <span class="boldface">Supply Voltage and Current Consumption</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_03<span style="word-spacing: NaNpt"> </span>The card shall work according to specifications within the consumption limits specified in ISO/IEC 7816-3.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_04<span style="word-spacing: NaNpt"> </span>The card shall work with Vcc = 3V (± 0,3V) or with Vcc = 5V (± 0,5V).</p>
            </div>
<p class="list">Voltage selection shall be performed according to ISO/IEC 7816-3.</p>
<p class="title-gr-seq-level-3" id="id-311d384f-1e2e-4351-8257-bc1c87fc0112">2.2.   <span class="boldface">
                  <span class="boldface">Programming Voltage V<span class="subscript">pp</span>
                  </span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_05<span style="word-spacing: NaNpt"> </span>The card shall not require a programming voltage at pin C6. It is expected that pin C6 is not connected in an IFD. Contact C6 may be connected to V<span class="subscript">cc</span> in the card but shall not be connected to ground. This voltage should not be interpreted in any case.</p>
            </div>
<p class="title-gr-seq-level-3" id="id-e8e44a93-e76d-4452-b47d-7f0622523e04">2.3.   <span class="boldface">
                  <span class="boldface">Clock generation and Frequency</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_06<span style="word-spacing: NaNpt"> </span>The card shall operate within a frequency range of 1 to 5 MHz and may support higher frequencies. Within one card session the clock frequency may vary ± 2 %. The clock frequency is generated by the Vehicle Unit and not the card itself. The duty cycle may vary between 40 and 60 %.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_07<span style="word-spacing: NaNpt"> </span>Under conditions contained into the card file EF ICC, the external clock can be stopped. The first byte of the EF ICC file body codes the Clockstop mode conditions:</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="10%"/>
                  <col width="10%"/>
                  <col width="10%"/>
                  <col width="71%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Low</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">High</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td rowspan="2" valign="top" style="font-weight: bold">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Bit 3</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Bit 2</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Bit 1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Clockstop allowed, no preferred level</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Clockstop allowed, high level preferred</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Clockstop allowed, low level preferred</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Clockstop not allowed</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Clockstop only allowed on high level</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Clockstop only allowed on low level</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="list">Bits 4 to 8 are not used.</p>
<p class="title-gr-seq-level-3" id="id-9bc76a2c-e80e-4ac0-b08d-b991fa7dc96d">2.4.   <span class="boldface">
                  <span class="boldface">I/O Contact</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_08<span style="word-spacing: NaNpt"> </span>The I/O contact C7 is used to receive data from and to transmit data to the IFD. During operation only either the card or the IFD shall be in transmit mode. Should both units be in transmit mode no damage shall occur to the card. Unless transmitting, the card shall enter the reception mode.</p>
            </div>
<p class="title-gr-seq-level-3" id="id-1e031efc-8523-44de-a8e6-ad66a5d0b8bf">2.5.   <span class="boldface">
                  <span class="boldface">States of the Card</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_09<span style="word-spacing: NaNpt"> </span>The card works in two states while the supply voltage is applied:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div class="list">Operation state while executing commands or interfacing with Vehicle Unit,</div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="list">Idle state at all other times; in this state all data shall be retained by the card.</div>
<p class="title-gr-seq-level-2" id="id-2408ca19-9968-406a-b26c-cfa5b5b0f4bc">3.   <span class="boldface">HARDWARE AND COMMUNICATION</span>
            </p>
<p class="title-gr-seq-level-3" id="id-81a45f90-1cf6-4c88-80a5-d809e55bc064">3.1.   <span class="boldface">
                  <span class="boldface">Introduction</span>
               </span>
            </p>
<p class="norm">This paragraph describes the minimum functionality required by Tachograph cards and VUs to ensure correct operation and interoperability.</p>
<p class="norm">Tachograph cards are as compliant as possible with the available ISO/IEC applicable norms (especially ISO/IEC 7816). However, commands and protocols are fully described in order to specify some restricted usage or some differences if they exist. The commands specified are fully compliant with the referred norms except where indicated.</p>
<p class="title-gr-seq-level-3" id="id-60fac66f-5373-44c8-b611-6ccbc6d1f5f4">3.2.   <span class="boldface">
                  <span class="boldface">Transmission Protocol</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_10<span style="word-spacing: NaNpt"> </span>The Transmission protocol shall be compliant with ISO/IEC 7816-3 for T = 0 and T = 1. In particular, the VU shall recognise waiting time extensions sent by the card.</p>
            </div>
<p class="title-gr-seq-level-4" id="id-8ec91699-8701-4c7a-a209-f815afac1200">3.2.1   <span class="boldface">
                  <span class="italics">Protocols</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_11<span style="word-spacing: NaNpt"> </span>The card shall provide both protocol <span class="boldface">T=0</span> and protocol <span class="boldface">T=1</span>. In addition the card may support further contact-oriented protocols.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_12<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">T=0</span> is the default protocol, a <span class="boldface">PTS</span> command is therefore necessary to change the protocol to <span class="boldface">T=1</span>.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_13<span style="word-spacing: NaNpt"> </span>Devices shall support <span class="boldface">direct convention</span> in both protocols: the direct convention is hence mandatory for the card.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_14<span style="word-spacing: NaNpt"> </span>The <span class="boldface">Information Field Size Card</span> byte shall be presented at the ATR in character TA3. This value shall be at least ‘F0h’ (=240 bytes).</p>
            </div>
<p class="norm">The following restrictions apply to the protocols:</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_15<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">T=0</span>
               </p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The interface device shall support an answer on I/O after the rising edge of the signal on RST from 400 cc.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The interface device shall be able to read characters separated with 12 etu.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The interface device shall read an erroneous character and its repetition if separated with 13 etu. If an erroneous character is detected, the Error signal on I/O can occur between 1 etu and 2 etu. The device shall support a 1 etu delay.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The interface device shall accept a 33 bytes ATR (TS+32)</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If TC1 is present in the ATR, the Extra Guard Time shall be present for characters sent by the interface device although characters sent by the card can still be separated with 12 etu. This is also true for the ACK character sent by the card after a P3 character emitted by the interface device.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The interface device shall take into account a NUL character emitted by the card.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The interface device shall accept the complementary mode for ACK.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The get-response command cannot be used in chaining mode to get a data which length could exceed 255 bytes.</div>
               </div>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_16<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">T=1</span>
               </p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">NAD byte: not used (NAD shall be set to ‘00’).</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">S-block ABORT: not used.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">S-block VPP state error: not used.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: DELETED">▼M3</a> —————</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The Information Field Size Device (IFSD) shall be indicated by the IFD immediately after the ATR: the IFD shall transmit the S-Block IFS request after the ATR and the card shall send back S-Block IFS. The recommended value for IFSD is 254 bytes.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The card will not ask for an IFS readjustment.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-d0bf9501-ae53-417e-85c8-b786234feec0">3.2.2   <span class="boldface">
                  <span class="italics">ATR</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_17<span style="word-spacing: NaNpt"> </span>The device checks ATR bytes, according to ISO/IEC 7816-3. No verification shall be done on ATR Historical Characters.</p>
            </div>
<p class="list">Example of Basic Biprotocol ATR according to ISO/IEC 7816-3</p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="11%"/>
                  <col width="53%"/>
                  <col width="37%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Character</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Remarks</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">TS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘3Bh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Indicates direct convention.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">T0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘85h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">TD1 present; 5 historical bytes are presents.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">TD1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘80h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">TD2 present; T=0 to be used</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">TD2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘11h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">TA3 present; T=1 to be used</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">TA3</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’ (at least ‘F0h’)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Information Field Size Card ( IFSC)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">TH1 to TH5</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Historical characters</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">TCK</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Check Character (exclusive OR)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_18<span style="word-spacing: NaNpt"> </span>After the Answer To Reset (ATR), the Master File (MF) is implicitly selected and becomes the Current Directory.</p>
            </div>
<p class="title-gr-seq-level-4" id="id-abca47e7-5999-413d-a2f6-25487b9a0bfe">3.2.3   <span class="boldface">
                  <span class="italics">PTS</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_19<span style="word-spacing: NaNpt"> </span>The default Protocol is T=0. To set the T=1 protocol, a PTS (also known as PPS) must be sent to the card by the device.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_20<span style="word-spacing: NaNpt"> </span>As both T=0 and T=1 protocols are mandatory for the card, the basic PTS for protocol switching is mandatory for the card.</p>
            </div>
<p class="list">The PTS can be used, as indicated in ISO/IEC 7816-3, to switch to higher baud rates than the default one proposed by the card in the ATR if any (TA(1) byte).</p>
<p class="list">Higher baud rates are optional for the card.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_21<span style="word-spacing: NaNpt"> </span>If no other baud rate than the default one are supported (or if the selected baud rate is not supported), the card shall respond to the PTS correctly according to ISO/IEC 7816-3 by omitting the PPS1 byte.</p>
            </div>
<p class="list">Examples of basic PTS for protocol selection are the following:</p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="20%"/>
                  <col width="78%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Character</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Remarks</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PPSS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘FFh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The Initiate Character.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PPS0</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’ or ‘01h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">PPS1 to PPS3 are not present; ‘00h’ to select T0, ‘01h’ to select T1.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PK</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">Check Character: <p class="normal">‘XXh’ = ‘FFh’ if PPS0 = ‘00h’,</p>
                           <p class="normal">‘XXh’ = ‘FEh’ if PPS0 = ‘01h’.</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="title-gr-seq-level-3" id="id-8ed1545b-1060-448b-98f3-56e1250d8ec7">3.3.   <span class="boldface">
                  <span class="boldface">Access Rules</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_22<span style="word-spacing: NaNpt"> </span>An access rule specifies for an access mode, i.e. command, the corresponding security conditions. If these security conditions are fulfilled the corresponding command is processed.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_23<span style="word-spacing: NaNpt"> </span>The following security conditions are used for the tachograph card:</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="10%"/>
                  <col width="90%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Abbreviation</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Meaning</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The action is always possible and can be executed without any restriction. Command and response APDU are sent in plain text, i.e. without secure messaging.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">NEV</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The action is never possible.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PLAIN-C</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The command APDU is sent in plain, i.e. without secure messaging.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PWD</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The action may only be executed if the workshop card PIN has been successfully verified, i.e. if the card internal security status ‘PIN_Verified’ is set. The command must be sent without secure messaging.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EXT-AUT-G1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The action may only be executed if the External Authenticate command for the generation 1 authentication (see also Appendix 11 Part A) has been successfully performed.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SM-MAC-G1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The APDU (command and response) must be applied with generation 1 secure messaging in authentication-only mode (see Appendix 11 Part A).</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SM-C-MAC-G1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The command APDU must be applied with generation 1 secure messaging in authentication only mode (see Appendix 11 Part A).</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SM-R-ENC-G1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The response APDU must be applied with generation 1 secure messaging in encryption mode (see Appendix 11 Part A), i.e. no message authentication code is returned.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SM-R-ENC-MAC-G1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The response APDU must be applied with generation 1 secure messaging in encrypt-then-authenticate mode (see Appendix 11 Part A).</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The APDU (command and response) must be applied with generation 2 secure messaging in authentication-only mode (see Appendix 11 Part B).</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SM-C-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The command APDU must be applied with generation 2 secure messaging in authentication only mode (see Appendix 11 Part B).</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SM-R-ENC-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">The response APDU must be applied with generation 2 secure messaging in encrypt-then-authenticate mode (see Appendix 11 Part B).</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_24<span style="word-spacing: NaNpt"> </span>These security conditions can be linked in the following ways:</p>
            </div>
<p class="norm">AND : All security conditions must be fulfilled</p>
<p class="norm">OR : At least one security condition must be fulfilled</p>
<p class="list">The access rules for the file system, i.e. the SELECT, READ BINARY and UPDATE BINARY command, are specified in chapter 4. The access rules for the remaining commands are specified in the following tables. The term ‘not applicable’ is used if there is no requirement to support the command. In this case the command may or may not be supported, but the access condition is out of scope.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_25<span style="word-spacing: NaNpt"> </span>In the DF Tachograph G1 application the following access rules are used:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="28%"/>
                  <col width="30%"/>
                  <col width="14%"/>
                  <col width="14%"/>
                  <col width="14%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Command</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Driver Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Workshop Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Control Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Company Card</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">External Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  For generation 1 authentication</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  For generation 2 authentication</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">PWD</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Internal Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">PWD</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">General Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Get Challenge</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MSE:SET AT</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MSE:SET DST</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Process DSRC Message</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Compute Digital Signature</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Hash</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PERFORM HASH of FILE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Verify Certificate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Verify Digital Signature</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Verify</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_26<span style="word-spacing: NaNpt"> </span>In the DF Tachograph_G2 application the following access rules are used:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="28%"/>
                  <col width="30%"/>
                  <col width="14%"/>
                  <col width="14%"/>
                  <col width="14%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Command</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Driver Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Workshop Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Control Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Company Card</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">External Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  For generation 1 authentication</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  For generation 2 authentication</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">PWD</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Internal Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">General Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Get Challenge</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MSE:SET AT</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MSE:SET DST</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Process DSRC Message</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Compute Digital Signature</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Hash</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PERFORM HASH of FILE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW OR</p>
                           <p class="tbl-norm">SM-MAC-G2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Verify Certificate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Verify Digital Signature</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Verify</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_27<span style="word-spacing: NaNpt"> </span>In the MF the following access rules are used:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="34%"/>
                  <col width="16%"/>
                  <col width="16%"/>
                  <col width="16%"/>
                  <col width="16%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Command</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Driver Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Workshop Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Control Card</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Company Card</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">External Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  For generation 1 authentication</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  For generation 2 authentication</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">PWD</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Internal Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">General Authenticate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Get Challenge</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MSE:SET AT</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MSE:SET DST</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Process DSRC Message</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Compute Digital Signature</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Hash</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PERFORM HASH of FILE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Verify Certificate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PSO: Verify Digital Signature</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Verify</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Not applicable</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_28<span style="word-spacing: NaNpt"> </span>A tachograph card may or may not accept a command with a higher level of security than the one specified in the security conditions. I.e. if the security condition is ALW (or PLAIN-C) the card may accept a command with secure messaging (encryption and / or authentication mode). If the security condition requires secure messaging with authentication mode, the tachograph card may accept a command with secure messaging of the same generation in authentication and encryption mode.</p>
            </div>
<p class="norm">
               <span class="italics">Note:</span> The command descriptions provide more information on the support of the commands for the different tachograph card types and the different DFs.</p>
<p class="title-gr-seq-level-3" id="id-13716e2a-0a98-4f30-acce-09ad669b82a0">3.4.   <span class="boldface">
                  <span class="boldface">Commands and error codes overview</span>
               </span>
            </p>
<p class="norm">Commands and file organisation are deduced from and complies with ISO/IEC 7816-4.</p>
<p class="norm">This section describes the following APDU command-response pairs. The command variants which are supported by a generation 1 and 2 application are specified in the corresponding command descriptions.</p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="46%"/>
                  <col width="54%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Command</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SELECT</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘A4h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">READ BINARY</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B0h’, ‘B1h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">UPDATE BINARY</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘D6h’, ‘D7h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">GET CHALLENGE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘84h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">VERIFY</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘20h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">GET RESPONSE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘C0h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">PERFORM SECURITY OPERATION</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  VERIFY CERTIFICATE</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  COMPUTE DIGITAL SIGNATURE</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  VERIFY DIGITAL SIGNATURE</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  HASH</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  PERFORM HASH OF FILE</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  PROCESS DSRC MESSAGE</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INTERNAL AUTHENTICATE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘88h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EXTERNAL AUTHENTICATE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘82h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MANAGE SECURITY ENVIRONMENT</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘22h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  SET DIGITAL SIGNATURE TEMPLATE</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">—  SET AUTHENTICATION TEMPLATE</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">GENERAL AUTHENTICATE</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘86h’</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_29<span style="word-spacing: NaNpt"> </span>The status words SW1 SW2 are returned in any response message and denote the processing state of the command.</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="6%"/>
                  <col width="88%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">SW1</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">SW2</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Meaning</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">90</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Normal processing.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">61</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">XX</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Normal processing. XX = number of response bytes available.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">62</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">81</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Warning processing. Part of returned data may be corrupted</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">63</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Authentication failed (Warning)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">63</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CX</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Wrong CHV (PIN). Remaining attempts counter provided by ‘X’.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">64</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Execution error - State of non-volatile memory unchanged. Integrity error.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">65</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Execution error - State of non-volatile memory changed</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">65</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">81</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Execution error - State of non-volatile memory changed – Memory failure</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">66</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">88</p>
                        </td>
                        <td valign="top">Security error: <p class="normal">wrong cryptographic checksum (during Secure Messaging) or</p>
                           <p class="normal">wrong certificate (during certificate verification) or</p>
                           <p class="normal">wrong cryptogram (during external authentication) or</p>
                           <p class="normal">wrong signature (during signature verification)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">67</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Wrong length (wrong Lc or Le)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">68</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">83</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Last command of the chain expected</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">69</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Forbidden command (no response available in T=0)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">69</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">82</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Security status not satisfied.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">69</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">83</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Authentication method blocked.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">69</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Conditions of use not satisfied.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">69</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">86</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Command not allowed (no current EF).</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">69</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">87</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Expected Secure Messaging Data Objects missing</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">69</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">88</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Incorrect Secure Messaging Data Objects</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6A</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">80</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Incorrect parameters in data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6A</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">82</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">File not found.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6A</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">86</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Wrong parameters P1-P2.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6A</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">88</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Referenced data not found.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6B</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Wrong parameters (offset outside the EF).</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6C</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">XX</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Wrong length, SW2 indicates the exact length. No data field is returned.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6D</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Instruction code not supported or invalid.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6E</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Class not supported.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">6F</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">00</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">—  Other checking errors</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="list">Additional status words as defined in ISO/IEC 7816-4 can be returned, if their behaviour is not explicitly mentioned in this appendix.</p>
<p class="list">For example the following status words can be optionally returned:</p>
<p class="list">6881: Logical channel not supported</p>
<p class="list">6882: Secure messaging not supported</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_30<span style="word-spacing: NaNpt"> </span>If more than one error condition is fulfilled in one command APDU the card may return any of the appropriate status words.</p>
            </div>
<p class="title-gr-seq-level-3" id="id-867dbe60-076b-4723-b907-69e8c7a3fdcc">3.5.   <span class="boldface">
                  <span class="boldface">Command descriptions</span>
               </span>
            </p>
<p class="norm">The mandatory commands for the Tachograph cards are described in this chapter.</p>
<p class="norm">Additional relevant details, related to cryptographic operations involved, are given in Appendix 11 Common security mechanisms for Tachograph Generation 1 and Generation 2.</p>
<p class="norm">All commands are described independently of the used protocol (T=0 or T=1). The APDU bytes CLA, INS, P1, P2, Lc and Le are always indicated. If Lc or Le is not needed for the described command, the associated length, value and description are empty.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_31<span style="word-spacing: NaNpt"> </span>If both length bytes (Lc and Le) are requested, the described command has to be split in two parts if the IFD is using protocol T=0: the IFD sends the command as described with P3=Lc + data and then sends a GET RESPONSE (see § 3.5.6) command with P3=Le.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_32<span style="word-spacing: NaNpt"> </span>If both length bytes are requested, and Le=0 (secure messaging):</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">When using protocol T=1, the card shall answer to Le=0 by sending all available output data.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">When using protocol T=0, the IFD shall send the first command with P3=Lc + data, the card shall answer (to this implicit Le=0) by the Status bytes ‘
                                       <span class="boldface">61La</span>
                                       ’, where La is the number of response bytes available. The IFD shall then generate a GET RESPONSE command with P3 = La to read the data.</div>
               </div>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_33<span style="word-spacing: NaNpt"> </span>A tachograph card may support extended length fields according to ISO/IEC 7816-4 as an optional feature. A tachograph card that supports extended length fields shall</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">Indicate the extended length field support in the ATR</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">Provide the supported buffer sizes by means of the extended length information in the EF ATR/INFO see TCS_146.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">Indicate whether it supports extended length fields for T = 1 and / or T = 0 in the EF Extended Length, see TCS_147.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">Support extended length fields for the tachograph application generation 1 and 2.</div>
               </div>
            </div>
<p class="title-gr-seq-level-3" id="id-a7f47390-26c5-4c45-9e9b-267eea43c0e6">
               <span class="italics">Notes:</span>
            </p>
<p class="norm">All commands are specified for short length fields. The usage of extended length APDUs is clear from ISO/IEC 7816-4.</p>
<p class="norm">In general the commands are specified for the plain mode, i.e. without secure messaging, as the secure messaging layer is specified in Appendix 11. It is clear from the access rules for a command whether the command shall support secure messaging or not and whether the command shall support generation 1 and / or generation 2 secure messaging. Some command variants are described with secure messaging to illustrate the usage of secure messaging.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_34<span style="word-spacing: NaNpt"> </span>The VU shall perform the complete generation 2 VU — card mutual authentication protocol for a session including the certificate verification (if required) either in the DF Tachograph, the DF Tachograph_G2 or the MF.</p>
            </div>
<p class="title-gr-seq-level-4" id="id-864c36ce-7718-4cfb-9b4c-3819f88d3e02">3.5.1   <span class="boldface">
                  <span class="italics">SELECT</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4, but has a restricted usage compared to the command defined in the norm.</p>
<p class="norm">The SELECT command is used:</p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">to select an application DF (selection by name must be used)</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">to select an elementary file corresponding to the submitted file ID</div>
               </div>
            </div>
<p class="title-gr-seq-level-5" id="id-0d326820-3a53-4636-80e9-37c60dbcb2a3">3.5.1.1   <span class="boldface">
                  <span class="expanded">Selection by name (AID)</span>
               </span>
            </p>
<p class="norm">This command allows selecting an application DF in the card.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_35<span style="word-spacing: NaNpt"> </span>This command can be performed from anywhere in the file structure (after the ATR or at any time).</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_36<span style="word-spacing: NaNpt"> </span>The selection of an application resets the current security environment. After performing the application selection, no current public key is selected anymore. The EXT-AUT-G1 access condition is also lost. If the command was performed without secure messaging, the former secure messaging session keys are no longer available.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_37<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="5%"/>
                  <col width="3%"/>
                  <col width="11%"/>
                  <col width="82%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘A4h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘04h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Selection by name (AID)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ch’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No response expected</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Number of bytes sent to the card (length of the AID):</p>
                           <p class="tbl-norm">‘06h’ for the Tachograph application</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">AID: ‘FF 54 41 43 48 4F’ for the Generation 1 tachograph application</p>
                           <p class="tbl-norm">AID: ‘FF 53 4D 52 44 54’ for the Generation 2 tachograph application</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="list">No response to the SELECT command is needed (Le absent in T=1, or no response asked in T=0).</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_38<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message (no response asked)</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the application corresponding with the AID is not found, the processing state returned is ‘
                                             <span class="boldface">6A82</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">In T=1, if the byte Le is present, the state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">In T=0, if a response is asked after the SELECT command, the state returned is ‘
                                             <span class="boldface">6900</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected application is considered to be corrupted (integrity error is detected within the file attributes), the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-5" id="id-e408b184-2da9-41ec-9015-8c07c3ec3f52">3.5.1.2   <span class="boldface">
                  <span class="expanded">Selection of an Elementary File using its File Identifier</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_39<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_40<span style="word-spacing: NaNpt"> </span>A tachograph card shall support the generation 2 secure messaging as specified in Appendix 11 Part B for this command variant.</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="9%"/>
                  <col width="33%"/>
                  <col width="50%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘A4h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘02h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Selection of an EF under the current DF</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ch’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No response expected</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘02h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Number of bytes sent to the card</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#7</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">File Identifier</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="list">No response to the SELECT command is needed (Le absent in T=1, or no response asked in T=0).</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_41<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message (no response asked)</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the file corresponding with the file identifier is not found, the processing state returned is ‘
                                             <span class="boldface">6A82</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">In T=1, if the byte Le is present, the state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">In T=0, if a response is asked after the SELECT command, the state returned is ‘
                                             <span class="boldface">6900</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected file is considered to be corrupted (integrity error is detected within the file attributes), the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-aaf6996a-ff21-46ed-9d17-6daffb9aeb31">3.5.2   <span class="boldface">
                  <span class="italics">READ BINARY</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4, but has a restricted usage compared to the command defined in the norm.</p>
<p class="norm">The READ BINARY command is used to read data from a transparent file.</p>
<p class="norm">The response of the card consists of returning the data read, optionally encapsulated in a secure messaging structure.</p>
<p class="title-gr-seq-level-5" id="id-9664e8d6-309a-4f1b-ae1d-708fe32fb2a6">3.5.2.1   <span class="boldface">
                  <span class="expanded">Command with offset in P1-P2</span>
               </span>
            </p>
<p class="norm">This command enables the IFD to read data from the EF currently selected, without secure messaging.</p>
<p class="norm">
               <span class="italics">Note:</span> This command without secure messaging can only be used to read a file that supports the ALW security condition for the Read access mode.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_42<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="3%"/>
                  <col width="6%"/>
                  <col width="19%"/>
                  <col width="71%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B0h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Read Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset in bytes from the beginning of the file: Most Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset in bytes from the beginning of the file: Least Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of data expected. Number of Bytes to be read.</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="norm">
               <span class="italics">Note:</span> bit 8 of P1 must be set to 0.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_43<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="9%"/>
                  <col width="11%"/>
                  <col width="41%"/>
                  <col width="39%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#X</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">X</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Data read</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no EF is selected, the processing state returned is ‘
                                             <span class="boldface">6986</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the security conditions of the selected file are not satisfied, the command is interrupted with ‘
                                             <span class="boldface">6982</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the Offset is not compatible with the size of the EF (Offset &gt; EF size), the processing state returned is ‘
                                             <span class="boldface">6B00</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the size of the data to be read is not compatible with the size of the EF (Offset + Le &gt; EF size) the processing state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’ or ‘
                                             <span class="boldface">6Cxx</span>
                                             ’ where ‘xx’ indicates the exact length.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the file attributes, the card shall consider the file as corrupted and unrecoverable, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the stored data, the card shall return the demanded data, and the processing state returned is ‘
                                             <span class="boldface">6281</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-6" id="id-68018408-9fd4-454e-bb03-2c7980aea4e5">3.5.2.1.1   <span class="boldface">
                  <span class="expanded">Command with secure messaging (examples)</span>
               </span>
            </p>
<p class="norm">This command enables the IFD to read data from the EF currently selected with secure messaging, in order to verify the integrity of the data received and to protect the confidentiality of the data if the security condition SM-R-ENC-MAC-G1 (generation 1) or SM-R-ENC-MAC-G2 (generation 2) is applied.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_44<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="3%"/>
                  <col width="2%"/>
                  <col width="7%"/>
                  <col width="88%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ch’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Secure Messaging asked</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B0h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Read Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P1 ( offset in bytes from the beginning of the file): Most Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P2 ( offset in bytes from the beginning of the file): Least Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of input data for secure messaging</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘97h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">LE</span>: Tag for expected length specification.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘01h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">LE</span>: Length of expected length</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Expected length specification (original Le): Number of Bytes to be read</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#9</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">CC</span>: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#10</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">CC</span>: Length of following cryptographic checksum</p>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘04h’ for Generation 1 secure messaging (see Appendix 11 Part A)</p>
                           </div>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#11-#(10+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">As specified in ISO/IEC 7816-4</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_45<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message if SM-R-ENC-MAC-G1 (generation 1) / SM-R-ENC-MAC-G2 (generation 2) is not required and if Secure Messaging input format is correct:</span>
               </p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="1%"/>
                  <col width="7%"/>
                  <col width="87%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘81h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">PV</span>: Tag for plain value data</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’ or</p>
                           <p class="tbl-norm">‘81 NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">PV</span>: length of returned data (=original Le).</p>
                           <p class="tbl-norm">L is 2 bytes if L<span class="subscript">PV</span>&gt;127 bytes.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(2+L) - #(1+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Plain Data value</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(2+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘99h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag for Processing Status (SW1-SW2) – optional for generation 1 secure messaging</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(3+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘02h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of Processing Status – optional for generation 1 secure messaging</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(4+L+NN) - #(5+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Processing Status of the unprotected response APDU – optional for generation 1 secure messaging</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(6+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">TCC: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">LCC: Length of following cryptographic checksum</p>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘04h’ for Generation 1 secure messaging (see Appendix 11 Part A)</p>
                           </div>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(8+L+NN)-#(7+M+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">M</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_46<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message if SM-R-ENC-MAC-G1 (generation 1) / SM-R-ENC-MAC-G2 (generation 2) is required and if Secure Messaging input format is correct:</span>
               </p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="1%"/>
                  <col width="7%"/>
                  <col width="87%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘87h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">PI CG</span>: Tag for encrypted data (cryptogram)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘MMh’ or</p>
                           <p class="tbl-norm">‘81 MMh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">PI CG</span>: length of returned encrypted data (different of original Le of the command due to padding).</p>
                           <p class="tbl-norm">L is 2 bytes if LPI CG &gt; 127 bytes.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(2+L)-#(1+L+MM)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">MM</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘01XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Encrypted Data: Padding Indicator and cryptogram</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(2+L+MM)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘99h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag for Processing Status (SW1-SW2) – optional for generation 1 secure messaging</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(3+L+MM)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘02h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of Processing Status – optional for generation 1 secure messaging</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(4+L+MM) - #(5+L+MM)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Processing Status of the unprotected response APDU – optional for generation 1 secure messaging</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(6+L+MM)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">TCC: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L+MM)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">LCC: Length of following cryptographic checksum</p>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘04h’ for Generation 1 secure messaging (see Appendix 11 Part A)</p>
                           </div>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(8+L+MM)-#(7+N+L+MM)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">N</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="list">The READ BINARY command may return regular processing states listed in TCS_43 under Tag ‘99h’ as described in TCS_59 using the secure messaging response structure.</p>
<p class="list">Additionally, some errors specifically related to secure messaging can happen. In that case, the processing state is simply returned, with no secure messaging structure involved:</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_47<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message if incorrect Secure Messaging input format</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no current session key is available, the processing state ‘
                                                <span class="boldface">6A88</span>
                                                ’ is returned. It happens either if the session key has not already been generated or if the session key validity has expired (in this case the IFD must re-run a mutual authentication process to set a new session key).</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some expected data objects (as specified above) are missing in the secure messaging format, the processing state ‘
                                                <span class="boldface">6987</span>
                                                ’ is returned: this error happens if an expected tag is missing or if the command body is not properly constructed.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some data objects are incorrect, the processing state returned is ‘
                                                <span class="boldface">6988</span>
                                                ’: this error happens if all the required tags are present but some lengths are different from the ones expected.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the verification of the cryptographic checksum fails, the processing state returned is ‘
                                                <span class="boldface">6688</span>
                                                ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-5" id="id-55ca4d03-cdd1-4d05-8953-990d64d8853d">3.5.2.2   <span class="boldface">
                  <span class="expanded">Command with short EF (Elementary File) identifier</span>
               </span>
            </p>
<p class="norm">This command variant enables the IFD to select an EF by means of a short EF identifier and read data from this EF.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_48<span style="word-spacing: NaNpt"> </span>A tachograph card shall support this command variant for all Elementary Files with a specified short EF identifier. These short EF identifiers are specified in chapter 4.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_49<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="3%"/>
                  <col width="7%"/>
                  <col width="21%"/>
                  <col width="70%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B0h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Read Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Bit 8 is set to 1</p>
                           <p class="tbl-norm">Bit 7 and 6 are set to 00</p>
                           <p class="tbl-norm">Bit 5 — 1 encode the short EF identifier of the corresponding EF</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Encodes an offset from 0 to 255 bytes in the EF referenced by P1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of data expected. Number of Bytes to be read.</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="norm">
               <span class="italics">Note:</span> The short EF identifiers used for the Generation 2 tachograph application are specified in chapter 4.</p>
<p class="list">If P1 encodes a short EF identifier and the command is successful, the identified EF becomes the currently selected EF (current EF).</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_50<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="9%"/>
                  <col width="11%"/>
                  <col width="41%"/>
                  <col width="39%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Data read</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the file corresponding with the short EF identifier is not found, the processing state returned is ‘
                                             <span class="boldface">6A82</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the security conditions of the selected file are not satisfied, the command is interrupted with ‘
                                             <span class="boldface">6982</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the Offset is not compatible with the size of the EF (Offset &gt; EF size), the processing state returned is ‘
                                             <span class="boldface">6B00</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the size of the data to be read is not compatible with the size of the EF (Offset + Le &gt; EF size) the processing state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’ or ‘
                                             <span class="boldface">6Cxx</span>
                                             ’ where ‘xx’ indicates the exact length.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the file attributes, the card shall consider the file as corrupted and unrecoverable, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the stored data, the card shall return the demanded data, and the processing state returned is ‘
                                             <span class="boldface">6281</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-5" id="id-a64453cc-6a09-4a7b-951a-09fc08a4e3bb">3.5.2.3   <span class="boldface">
                  <span class="expanded">Command with odd instruction byte</span>
               </span>
            </p>
<p class="norm">This command variant enables the IFD to read data from an EF with 32 768  bytes or more.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_51<span style="word-spacing: NaNpt"> </span>A tachograph card which supports EFs with 32 768  bytes or more shall support this command variant for these EFs. A tachograph card may or may not support this command variant for other EFs with the exception of the EF Sensor_Installation_Data see TCS_156 and TCS_160.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_52<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="5%"/>
                  <col width="1%"/>
                  <col width="12%"/>
                  <col width="81%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B1h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Read Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td rowspan="2" valign="top">
                           <p class="tbl-norm">Current EF</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc Length of offset data object.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset data object:</p>
                           <p class="tbl-norm">Tag ‘54h’</p>
                           <p class="tbl-norm">Length ‘01h’ or ‘02h’</p>
                           <p class="tbl-norm">Value offset</p>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="4">
                           <p class="modref">
                              <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;XXh&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">As specified in ISO/IEC 7816-4</p>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="4">
                           <p class="modref">
                              <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
                           </p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="list">The IFD shall encode the offset data object&#39;s length with a minimum possible number of octets, i.e. using the length byte ‘01h’ the IFD shall encode an offset from 0 to 255 and using the length byte ‘02h’ an offset from ‘256’ up to ‘
                                    65 535 
                                    ’ bytes.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: INSERTED">▼M1</a>
            </p>
<p class="list">In case of T = 0 the card assumes the value Le = ‘00h’ if no secure messaging is applied.</p>
<p class="list">In case of T = 1 the processing state returned is ‘6700’ if Le=‘01h’.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_53<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="4%"/>
                  <col width="5%"/>
                  <col width="20%"/>
                  <col width="71%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Data read encapsulated in a discretionary data object with tag ‘53h’.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no EF is selected, the processing state returned is ‘
                                             <span class="boldface">6986</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the security conditions of the selected file are not satisfied, the command is interrupted with ‘
                                             <span class="boldface">6982</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the Offset is not compatible with the size of the EF (Offset &gt; EF size), the processing state returned is ‘
                                             <span class="boldface">6B00</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the size of the data to be read is not compatible with the size of the EF (Offset + Le &gt; EF size) the processing state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’ or ‘
                                             <span class="boldface">6Cxx</span>
                                             ’ where ‘xx’ indicates the exact length.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the file attributes, the card shall consider the file as corrupted and unrecoverable, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the stored data, the card shall return the demanded data, and the processing state returned is ‘
                                             <span class="boldface">6281</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-6" id="id-2b3a2c6f-033b-4856-8f29-44035b5b770c">3.5.2.3.1   <span class="boldface">
                  <span class="expanded">Command with secure messaging (example)</span>
               </span>
            </p>
<p class="norm">The following example illustrates the usage of secure messaging if the security condition SM-MAC-G2 applies.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_54<span style="word-spacing: NaNpt"> </span>Command message</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="7%"/>
                  <col width="1%"/>
                  <col width="9%"/>
                  <col width="83%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ch’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Secure Messaging asked</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B1h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Read Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td rowspan="2" valign="top">
                           <p class="tbl-norm">Current EF</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of the secured data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B3h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag for plain value data encoded in BER-TLV</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">PV</span>: length of transmitted data</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(8)-#(7+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Plain Data encoded in BER-TLV, i.e. the offset data object with tag ‘54’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(8+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘97h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">LE</span>: Tag for expected length specification.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(9+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘01h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">LE</span>: Length of expected length</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(10+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Expected length specification (original Le): Number of bytes to be read</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(11+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">CC</span>: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(12+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">CC</span>: Length of following cryptographic checksum</p>
                           <p class="tbl-norm">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(13+NN)-#(12+M+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">M</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">As specified in ISO/IEC 7816-4</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_55<span style="word-spacing: NaNpt"> </span>Response message if the command is successful</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="1%"/>
                  <col width="9%"/>
                  <col width="82%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B3h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Plain Data encoded in BER-TLV</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’ or</p>
                           <p class="tbl-norm">‘81 NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">PV</span>: length of returned data (=original Le).</p>
                           <p class="tbl-norm">L is 2 bytes if L<span class="subscript">PV</span>&gt;127 bytes.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(2+L)-#(1+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Plain Data value encoded in BER-TLV, i.e. data read encapsulated in a discretionary data object with tag ‘53h’.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(2+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘99h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Processing Status of the unprotected response APDU</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(3+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘02h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of Processing Status</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(4+L+NN) — #(5+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Processing Status of the unprotected response APDU</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(6+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">CC</span>: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">CC</span>: Length of following cryptographic checksum</p>
                           <p class="tbl-norm">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(8+L+NN)-#(7+M+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">M</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="title-gr-seq-level-4" id="id-2ad66701-bb64-4738-a902-62a6a9be3b65">3.5.3   <span class="boldface">
                  <span class="italics">UPDATE BINARY</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4, but has a restricted usage compared to the command defined in the norm.</p>
<p class="norm">The UPDATE BINARY command message initiates the update (erase + write) of the bits already present in an EF binary with the bits given in the command APDU.</p>
<p class="title-gr-seq-level-5" id="id-92359ffd-c724-4a6a-87ad-281f6c0c0faf">3.5.3.1   <span class="boldface">
                  <span class="expanded">Command with offset in P1-P2</span>
               </span>
            </p>
<p class="norm">This command enables the IFD to write data into the EF currently selected, without the card verifying the integrity of data received.</p>
<p class="norm">
               <span class="italics">Note:</span> This command without secure messaging can only be used to update a file that supports the ALW security condition for the Update access mode.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_56<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="10%"/>
                  <col width="6%"/>
                  <col width="23%"/>
                  <col width="60%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘D6h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Update Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset in bytes from the beginning of the file: Most Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset in bytes from the beginning of the file: Least Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc Length of data to Update. Number of bytes to be written.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Data to be written</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="norm">
               <span class="italics">Note:</span> bit 8 of P1 must be set to 0.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_57<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no EF is selected, the processing state returned is ‘
                                             <span class="boldface">6986</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the security conditions of the selected file are not satisfied, the command is interrupted with ‘
                                             <span class="boldface">6982</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the Offset is not compatible with the size of the EF (Offset &gt; EF size), the processing state returned is ‘
                                             <span class="boldface">6B00</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the size of the data to be written is not compatible with the size of the EF (Offset + Lc &gt; EF size) the processing state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the file attributes, the card shall consider the file as corrupted and unrecoverable, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If writing is unsuccessful, the processing state returned is ‘
                                             <span class="boldface">6581</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-6" id="id-c2fadacd-5903-48c2-ad0f-cbcccd2cd86c">3.5.3.1.1   <span class="boldface">
                  <span class="expanded">Command with secure messaging (examples)</span>
               </span>
            </p>
<p class="norm">This command enables the IFD to write data into the EF currently selected, with the card verifying the integrity of data received. As no confidentiality is required, the data are not encrypted.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_58<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="1%"/>
                  <col width="7%"/>
                  <col width="86%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ch’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Secure Messaging asked</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘D6h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Update Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset in bytes from the beginning of the file:</p>
                           <p class="tbl-norm">Most Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset in bytes from the beginning of the file:</p>
                           <p class="tbl-norm">Least Significant Byte</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of the secured data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘81h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">PV</span>: Tag for plain value data</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’ or</p>
                           <p class="tbl-norm">‘81 NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">PV</span>: length of transmitted data.</p>
                           <p class="tbl-norm">L is 2 bytes if L<span class="subscript">PV</span> &gt; 127 bytes.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L)-#(6+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Plain Data value (Data to be written)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">CC</span>: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(8+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">CC</span>: Length of following cryptographic checksum‘04h’ for Generation 1 secure messaging (see Appendix 11 Part A)</p>
                           <p class="tbl-norm">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(9+L+NN)-#(8+M+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">M</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">As specified in ISO/IEC 7816-4</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_59<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response message if correct Secure Messaging input format</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="3%"/>
                  <col width="2%"/>
                  <col width="7%"/>
                  <col width="89%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘99h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">SW</span>: Tag for Status Words (to be protected by CC)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘02h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">SW</span>: length of returned Status Words</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#3-#4</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Processing Status of the unprotected response APDU</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#5</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">CC</span>: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">CC</span>: Length of following cryptographic checksum</p>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘04h’ for Generation 1 secure messaging (see Appendix 11 Part A)</p>
                           </div>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7-#(6+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="list">The ‘regular’ processing states, described for the UPDATE BINARY command with no secure messaging (see §3.5.3.1), can be returned using the response message structure described above.</p>
<p class="list">Additionally, some errors specifically related to secure messaging can happen. In that case, the processing state is simply returned, with no secure messaging structure involved:</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_60<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message if error in secure messaging</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no current session key is available, the processing state ‘
                                                <span class="boldface">6A88</span>
                                                ’ is returned.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some expected data objects (as specified above) are missing in the secure messaging format, the processing state ‘
                                                <span class="boldface">6987</span>
                                                ’ is returned: this error happens if an expected tag is missing or if the command body is not properly constructed.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some data objects are incorrect, the processing state returned is ‘
                                                <span class="boldface">6988</span>
                                                ’: this error happens if all the required tags are present but some lengths are different from the ones expected.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the verification of the cryptographic checksum fails, the processing state returned is ‘
                                                <span class="boldface">6688</span>
                                                ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-5" id="id-5a84710b-54fd-47c4-83ae-7a47e93241dc">3.5.3.2   <span class="boldface">
                  <span class="expanded">Command with short EF identifier</span>
               </span>
            </p>
<p class="norm">This command variant enables the IFD to select an EF by means of a short EF identifier and write data from this EF.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_61<span style="word-spacing: NaNpt"> </span>A tachograph card shall support this command variant for all Elementary Files with a specified short EF identifier. These short EF identifiers are specified in chapter 4.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_62<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="10%"/>
                  <col width="6%"/>
                  <col width="23%"/>
                  <col width="60%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘D6h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Update Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Bit 8 is set to 1</p>
                           <p class="tbl-norm">Bit 7 and 6 are set to 00</p>
                           <p class="tbl-norm">Bit 5 — 1 encode the short EF identifier of the corresponding EF</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Encodes an offset from 0 to 255 bytes in the EF referenced by P1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc Length of data to Update. Number of bytes to be written.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Data to be written</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_63<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="norm">
               <span class="italics">Note:</span> The short EF identifiers used for the generation 2 tachograph application are specified in chapter 4.</p>
<p class="list">If P1 encodes a short EF identifier and the command is successful, the identified EF becomes the currently selected EF (current EF).</p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the file corresponding with the short EF identifier is not found, the processing state returned is ‘
                                             <span class="boldface">6A82</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the security conditions of the selected file are not satisfied, the command is interrupted with ‘
                                             <span class="boldface">6982</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the Offset is not compatible with the size of the EF (Offset &gt; EF size), the processing state returned is ‘
                                             <span class="boldface">6B00</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the size of the data to be written is not compatible with the size of the EF (Offset + Lc &gt; EF size) the processing state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the file attributes, the card shall consider the file as corrupted and unrecoverable, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If writing is unsuccessful, the processing state returned is ‘
                                             <span class="boldface">6581</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-5" id="id-e4cd659d-29fc-4e33-b6b7-cd46a13f4cb6">3.5.3.3   <span class="boldface">
                  <span class="expanded">Command with odd instruction byte</span>
               </span>
            </p>
<p class="norm">This command variant enables the IFD to write data to an EF with 32 768  bytes or more.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_64<span style="word-spacing: NaNpt"> </span>A tachograph card which supports EFs with 32 768  bytes or more shall support this command variant for these EFs. A tachograph card may or may not support this command variant for other EFs.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_65<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="5%"/>
                  <col width="3%"/>
                  <col width="12%"/>
                  <col width="79%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘D7h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Update Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td rowspan="2" valign="top">
                           <p class="tbl-norm">Current EF</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc Length of data in the command data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Offset data object with tag ‘54h’ || Discretionary data object with tag ‘53h’ that encapsulates the data to be written</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="list">The IFD shall encode the offset data object&#39;s and the discretionary data object&#39;s length with the minimum possible number of octets, i.e. using the length byte ‘01h’ the IFD shall encode an offset / length from 0 to 255 and using the length byte ‘02h’ an offset / length from ‘256’ up to ‘
                                    65 535 
                                    ’ bytes.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_66<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no EF is selected, the processing state returned is ‘
                                             <span class="boldface">6986</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the security conditions of the selected file are not satisfied, the command is interrupted with ‘
                                             <span class="boldface">6982</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the Offset is not compatible with the size of the EF (Offset &gt; EF size), the processing state returned is ‘
                                             <span class="boldface">6B00</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the size of the data to be written is not compatible with the size of the EF (Offset + Lc &gt; EF size) the processing state returned is ‘
                                             <span class="boldface">6700</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If an integrity error is detected within the file attributes, the card shall consider the file as corrupted and unrecoverable, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6500</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If writing is unsuccessful, the processing state returned is ‘
                                             <span class="boldface">6581</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-6" id="id-b22f37d2-ce74-4923-874e-aa463f162a77">3.5.3.3.1   <span class="boldface">
                  <span class="expanded">Command with secure messaging (example)</span>
               </span>
            </p>
<p class="norm">The following example illustrates the usage of secure messaging if the security condition SM-MAC-G2 applies.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_67<span style="word-spacing: NaNpt"> </span>Command message</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="1%"/>
                  <col width="9%"/>
                  <col width="82%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ch’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Secure Messaging asked</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘D7h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Update Binary</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td rowspan="2" valign="top">
                           <p class="tbl-norm">Current EF</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of the secured data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B3h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag for plain value data encoded in BER-TLV</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’ or</p>
                           <p class="tbl-norm">‘81 NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">PV</span>: length of transmitted data.</p>
                           <p class="tbl-norm">L is 2 bytes if L<span class="subscript">PV</span> &gt; 127 bytes.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L)-#(6+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Plain Data encoded in BER-TLV, i.e. offset data object with tag ‘54h’ || Discretionary data object with tag ‘53h’ that encapsulates the data to be written</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">CC</span>: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(8+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">CC</span>: Length of following cryptographic checksum</p>
                           <p class="tbl-norm">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(9+L+NN)-#(8+M+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">M</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">As specified in ISO/IEC 7816-4</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_68<span style="word-spacing: NaNpt"> </span>Response message if the command is successful</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="4%"/>
                  <col width="2%"/>
                  <col width="9%"/>
                  <col width="85%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘99h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">SW</span>: Tag for Status Words (to be protected by CC)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘02h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">SW</span>: length of returned Status Words</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#3-#4</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Processing Status of the unprotected response APDU</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#5</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">T<span class="subscript">CC</span>: Tag for cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L<span class="subscript">CC</span>: Length of following cryptographic checksum</p>
                           <p class="tbl-norm">‘08h’, ‘0Ch’ or ‘10h’ depending on AES key length for Generation 2 secure messaging (see Appendix 11 Part B)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7-#(6+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Cryptographic checksum</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="title-gr-seq-level-4" id="id-01692b74-2bce-4995-82b3-df0391a70159">3.5.4   <span class="boldface">
                  <span class="italics">GET CHALLENGE</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4, but has a restricted usage compared to the command defined in the norm.</p>
<p class="norm">The GET CHALLENGE command asks the card to issue a challenge in order to use it in a security related procedure in which a cryptogram or some ciphered data are sent to the card.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_69<span style="word-spacing: NaNpt"> </span>The Challenge issued by the card is only valid for the next command, which uses a challenge, sent to the card.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_70<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="5%"/>
                  <col width="10%"/>
                  <col width="31%"/>
                  <col width="55%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘84h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘08h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Le (Length of Challenge expected).</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_71<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="9%"/>
                  <col width="11%"/>
                  <col width="41%"/>
                  <col width="39%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Challenge</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If Le is different from ‘08h’, the processing state is ‘
                                          <span class="boldface">6700</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If parameters P1-P2 are incorrect, the processing state is ‘
                                          <span class="boldface">6A86</span>
                                          ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-7dd8cc34-85da-4406-a7e4-4d077a284d3a">3.5.5   <span class="boldface">
                  <span class="italics">VERIFY</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4, but has a restricted usage compared to the command defined in the norm.</p>
<p class="norm">Only the workshop card is required to support this command.</p>
<p class="norm">Other types of tachograph cards may or may not implement this command, but for these cards no reference CHV is personalized. Therefore these cards cannot perform this commend successfully. For other types of tachograph cards than workshop cards the behavior, i.e. the error code returned, is out of the scope of this specification, if this command is sent.</p>
<p class="norm">The Verify command initiates the comparison in the card of the CHV (PIN) data sent from the command with the reference CHV stored in the card.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_72<span style="word-spacing: NaNpt"> </span>The PIN entered by the user must be ASCII encoded and right padded with ‘FFh’ bytes up to a length of 8 bytes by the IFD, see also the data type WorkshopCardPIN in Appendix 1.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_73<span style="word-spacing: NaNpt"> </span>The tachograph applications generation 1 and 2 shall use the same reference CHV.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_74<span style="word-spacing: NaNpt"> </span>The tachograph card shall check whether the command is encoded correctly. If the command is not encoded correctly the card shall not compare the CHV values, not decrement the remaining CHV attempt counter and not reset the security status ‘PIN_Verified’, but abort the command. A command is encoded correctly, if the CLA, INS, P1, P2, Lc bytes have the specified values, Le is absent, and the command data field has the correct length.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_75<span style="word-spacing: NaNpt"> </span>If the command is successful, the remaining CHV attempt counter is reinitialised. The initial value of the remaining CHV attempt counter is 5. If the command is successful the card shall set the internal security status ‘PIN_Verified’. The card shall reset this security status, if the card is reset or if the CHV code transmitted in the command does not match the stored reference CHV.</p>
            </div>
<p class="norm">
               <span class="italics">Note:</span> Using the same reference CHV and a global security status prevents that a workshop employee must re-enter the PIN after a selection of another tachograph application DF.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_76<span style="word-spacing: NaNpt"> </span>An unsuccessful comparison is recorded in the card, i.e. the remaining CHV attempts counter shall be decremented by one, in order to limit the number of further attempts of the use of the reference CHV.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_77<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="9%"/>
                  <col width="9%"/>
                  <col width="35%"/>
                  <col width="46%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘20h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P2 (the verified CHV is implicitly known)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘08h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of CHV code transmitted</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#13</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CHV</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_78<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the reference CHV is not found, the processing state returned is ‘
                                          <span class="boldface">6A88</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the CHV is blocked, (the remaining attempt counter of the CHV is null), the processing state returned is ‘
                                          <span class="boldface">6983</span>
                                          ’. Once in that state, the CHV can never be successfully presented anymore.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the comparison is unsuccessful, the remaining attempt Counter is decreased and the status ‘
                                          <span class="boldface">63CX</span>
                                          ’ is returned (X&gt;0 and X equals the remaining CHV attempts counter.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the reference CHV is considered corrupted, the processing state returned is ‘
                                          <span class="boldface">6400</span>
                                          ’ or ‘
                                          <span class="boldface">6581</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If Lc is different from ‘08h’, the processing state is ‘
                                          <span class="boldface">6700</span>
                                          ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-41789058-c7c6-4fd4-8164-f6527933731c">3.5.6   <span class="boldface">
                  <span class="italics">GET RESPONSE</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4.</p>
<p class="norm">This command (only necessary and available for T=0 Protocol) is used to transmit prepared data from the card to the interface device (case where a command had included both Lc and Le).</p>
<p class="norm">The GET RESPONSE command has to be issued immediately after the command preparing the data, otherwise, the data are lost. After the execution of the GET RESPONSE command (except if the error ‘
                              <span class="boldface">61xx</span>
                              ’ or ‘
                              <span class="boldface">6Cxx</span>
                              ’ occur, see below), the previously prepared data are no longer available.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_79<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="12%"/>
                  <col width="37%"/>
                  <col width="46%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘C0h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Number of bytes expected</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_80<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="9%"/>
                  <col width="11%"/>
                  <col width="41%"/>
                  <col width="39%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#X</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">X</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Data</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no data have been prepared by the card, the processing state returned is ‘
                                          <span class="boldface">6900</span>
                                          ’ or ‘
                                          <span class="boldface">6F00</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If Le exceeds the number of available bytes or if Le is null, the processing state returned is ‘
                                          <span class="boldface">6Cxx</span>
                                          ’, where xx denotes the exact number of available bytes. In that case, the prepared data are still available for a subsequent GET RESPONSE command.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If Le is not null and is smaller than the number of available bytes, the required data are sent normally by the card, and the processing state returned is ‘
                                          <span class="boldface">61xx</span>
                                          ’, where ‘xx’ indicates a number of extra bytes still available by a subsequent GET RESPONSE command.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is not supported (protocol T=1), the card returns ‘
                                          <span class="boldface">6D00</span>
                                          ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-cd72b150-a01e-48c2-8029-aa52f50f6233">3.5.7   <span class="boldface">
                  <span class="italics">PSO: VERIFY CERTIFICATE</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-8, but has a restricted usage compared to the command defined in the norm.</p>
<p class="norm">The VERIFY CERTIFICATE command is used by the card to obtain a Public Key from the outside and to check its validity.</p>
<p class="title-gr-seq-level-5" id="id-69d00210-cce0-48cf-a762-030047511dcf">3.5.7.1   <span class="boldface">
                  <span class="expanded">Generation 1 Command — Response pair</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_81<span style="word-spacing: NaNpt"> </span>This command variant is only supported by a generation 1 tachograph application.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_82<span style="word-spacing: NaNpt"> </span>When a VERIFY CERTIFICATE command is successful, the Public Key is stored for a future use in the Security environment. This key shall be explicitly set for the use in security related commands (INTERNAL AUTHENTICATE, EXTERNAL AUTHENTICATE or VERIFY CERTIFICATE) by the MSE command (see § 3.5.11) using its key identifier.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_83<span style="word-spacing: NaNpt"> </span>In any case, the VERIFY CERTIFICATE command uses the public key previously selected by the MSE command to open the certificate. This public key must be the one of a Member State or of Europe.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_84<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="6%"/>
                  <col width="21%"/>
                  <col width="67%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Perform Security Operation</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘AEh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P2: non BER-TLV coded data (concatenation of data elements)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘C2h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc: Length of the certificate, 194 bytes</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#199</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">194</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Certificate: concatenation of data elements (as described in Appendix 11)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_85<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the certificate verification fails, the processing state returned is ‘
                                             <span class="boldface">6688</span>
                                             ’. The verification and unwrapping process of the certificate is described in Appendix 11 for G1 and G2.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no Public Key is present in the Security Environment, ‘
                                             <span class="boldface">6A88</span>
                                             ’ is returned.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected public key (used to unwrap the certificate) is considered corrupted, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6581</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">Generation 1 only: If the selected public key (used to unwrap the certificate) has a CHA.LSB () different from ‘00’ (i.e. is not the one of a Member State or of Europe), the processing state returned is ‘
                                             <span class="boldface">6985</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-5" id="id-ed05e4c3-8b3e-482d-9c8d-5ea8a16c721b">3.5.7.2   <span class="boldface">
                  <span class="expanded">Generation 2 Command — Response pair</span>
               </span>
            </p>
<p class="norm">Depending on the curve size ECC certificates may be so long that they cannot be transmitted in a single APDU. In this case command chaining according to ISO/IEC 7816-4 must be applied and the certificate transmitted in two consecutive PSO: Verify Certificate APDUs.</p>
<p class="norm">The certificate structure and the domain parameters are defined in Appendix 11.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_86<span style="word-spacing: NaNpt"> </span>The command can be performed in the MF, DF Tachograph and DF Tachograph_G2, see also TCS_34.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_87<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="2%"/>
                  <col width="6%"/>
                  <col width="90%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘X0h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA byte indicating command chaining:</p>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘00h’ the only or last command of the chain</p>
                           </div>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘10h’ not the last command of a chain</p>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Perform Security Operation</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘BEh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Verify self-descriptive certificate</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of the command data field, see TCS_88 and TCS_89.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#5+L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded data: ECC Certificate Body data object as first data object concatenated with the ECC Certificate Signature data object as second data object or a part of this concatenation. The tag ‘7F21’ and the corresponding length shall not be transmitted.</p>
                           <p class="tbl-norm">The order of these data objects is fixed.</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_88<span style="word-spacing: NaNpt"> </span>For short length APDUs the following provisions apply: the IFD shall use the minimum number of APDUs required to transmit the command payload and transmit the maximum number of bytes in the first command APDU. However any value of ‘Lc’ up to 255 bytes must be supported by the card.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_89<span style="word-spacing: NaNpt"> </span>For extended length APDUs the following provisions apply: if the certificate does not fit into a single APDU, the card shall support command chaining. The IFD shall use the minimum number of APDUs required to transmit the command payload and transmit the maximum number of bytes in the first command APDU. If chaining is needed, any value of ‘Lc’ up to the maximum extended length size indicated must be supported by the card.</p>
            </div>
<p class="norm">Note: According to Appendix 11 the card stores the certificate or the relevant contents of the certificate and updates its currentAuthenticatedTime.</p>
<p class="list">The response message structure and status words are as defined in TCS_85.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_90<span style="word-spacing: NaNpt"> </span>In addition to the error codes listed in TCS_85, the card may return the following error codes:</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected public key (used to unwrap the certificate) has a CHA.LSB (CertificateHolderAuthorisation.equipmentType) that is not suitable for the certificate verification according to Appendix 11, the processing state returned is ‘
                                             <span class="boldface">6985</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the currentAuthenticatedTime of the card is later than the Certificate Expiration Date, the processing state returned is ‘
                                             <span class="boldface">6985</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the last command of the chain is expected, the card returns ‘
                                             <span class="boldface">6883</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If incorrect parameters are sent in the command data field, the card returns ‘
                                             <span class="boldface">6A80</span>
                                             ’ (also used in case the data objects are not sent in the specified order).</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-d1522247-ea68-4187-9b61-5122af7566f3">3.5.8   <span class="boldface">
                  <span class="italics">INTERNAL AUTHENTICATE</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_91<span style="word-spacing: NaNpt"> </span>All tachograph cards shall support this command in the DF Tachograph generation 1. The command may or may not be accessible in the MF and / or the DF Tachograph_G2. If so, the command shall terminate with a suitable error code as the private key of the card (Card.SK) for the generation 1 authentication protocol is only accessible in the DF_Tachograph generation 1.</p>
            </div>
<p class="norm">Using the INTERNAL AUTHENTICATE command, the IFD can authenticate the card. The authentication process is described in Appendix 11. It includes the following statements:</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_92<span style="word-spacing: NaNpt"> </span>The INTERNAL AUTHENTICATE command uses the card Private Key (implicitly selected) to sign authentication data including K1 (first element for session key agreement) and RND1, and uses the Public Key currently selected (through the last MSE command) to encrypt the signature and form the authentication token (more details in Appendix 11).</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_93<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="10%"/>
                  <col width="8%"/>
                  <col width="29%"/>
                  <col width="53%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘88h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘10h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of data sent to the card</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6 — #13</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Challenge used to authenticate the card</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#14 -#21</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">VU.CHR (see Appendix 11)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘80h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of the data expected from the card</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_94<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="9%"/>
                  <col width="4%"/>
                  <col width="30%"/>
                  <col width="57%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#128</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">128</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Card authentication token (see Appendix 11)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no Public Key is present in the Security Environment, the processing state returned is ‘
                                          <span class="boldface">6A88</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no Private Key is present in the Security Environment, the processing state returned is ‘
                                          <span class="boldface">6A88</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If VU.CHR does not match the current public key identifier, the processing state returned is ‘
                                          <span class="boldface">6A88</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected private key is considered corrupted, the processing state returned is ‘
                                          <span class="boldface">6400</span>
                                          ’ or ‘
                                          <span class="boldface">6581</span>
                                          ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_95<span style="word-spacing: NaNpt"> </span>If the INTERNAL AUTHENTICATE command is successful, the current generation 1 session key, if existing, is erased and no longer available. In order to have a new generation 1 session key available, the EXTERNAL AUTHENTICATE command for the generation 1 authentication mechanism must be successfully performed.</p>
            </div>
<div style="margin-left: 42pt; text-indent: -42pt">
               <p class="norm">
                  <span class="italics">Note:</span>
                  <span style="word-spacing: NaNpt"> </span>For generation 2 session keys see Appendix 11 CSM_193 and CSM_195. If generation 2 session keys are established and the tachograph card receives the plain INTERNAL AUTHENTICATE command APDU, it aborts the generation 2 secure messaging session and destroys the generation 2 session keys.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-95a56a71-367d-4890-b499-a07c49ea3f40">3.5.9   <span class="boldface">
                  <span class="italics">EXTERNAL AUTHENTICATE</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4.</p>
<p class="norm">Using the EXTERNAL AUTHENTICATE command, the card can authenticate the IFD. The authentication process is described in Appendix 11 for Tachograph G1 and G2 (VU authentication).</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_96<span style="word-spacing: NaNpt"> </span>The command variant for the generation 1 mutual authentication mechanism is only supported by a generation 1 tachograph application.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_97<span style="word-spacing: NaNpt"> </span>The command variant for the second generation VU-card mutual authentication can be performed in the MF, DF Tachograph and DF Tachograph_G2, see also TCS_34. If this generation 2 EXTERNAL AUTHENTICATE command is successful, the current generation 1 session key, if existing, is erased and no longer available.</p>
            </div>
<div style="margin-left: 42pt; text-indent: -42pt">
               <p class="norm">
                  <span class="italics">Note:</span>
                  <span style="word-spacing: NaNpt"> </span>For generation 2 session keys see Appendix 11 CSM_193 and CSM_195. If generation 2 session keys are established and the tachograph card receives the plain EXTERNAL AUTHENTICATE command APDU, it aborts the generation 2 secure messaging session and destroys the generation 2 session keys.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_98<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="4%"/>
                  <col width="3%"/>
                  <col width="11%"/>
                  <col width="81%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘82h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Keys and algorithms implicitly known</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc (Length of the data sent to the card )</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Generation 1 authentication: Cryptogram (see Appendix 11 Part A)</p>
                           <p class="tbl-norm">Generation 2 authentication: Signature generated by the IFD (see Appendix 11 Part B)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">TCS_99<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the CHA of the currently set public key is not the concatenation of the Tachograph application AID and of a VU equipment Type, the processing state returned is ‘
                                          <span class="boldface">6F00</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is not immediately preceded with a GET CHALLENGE command, the processing state returned is ‘
                                          <span class="boldface">6985</span>
                                          ’.</div>
               </div>
            </div>
<p class="list">The Generation 1 Tachograph application may return the following additional error codes:</p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no Public Key is present in the Security Environment, ‘
                                          <span class="boldface">6A88</span>
                                          ’ is returned.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no Private Key is present in the Security Environment, the processing state returned is ‘
                                          <span class="boldface">6A88</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the verification of the cryptogram is wrong, the processing state returned is ‘
                                          <span class="boldface">6688</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected private key is considered corrupted, the processing state returned is ‘
                                          <span class="boldface">6400</span>
                                          ’ or ‘
                                          <span class="boldface">6581</span>
                                          ’.</div>
               </div>
            </div>
<p class="list">The command variant for the Generation 2 authentication may return the following additional error code:</p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If signature verification failed, the card returns ‘
                                          <span class="boldface">6300</span>
                                          ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-7cd77b3d-2417-49db-9e76-fdf4d64f741a">3.5.10   <span class="boldface">
                  <span class="italics">GENERAL AUTHENTICATE</span>
               </span>
            </p>
<p class="norm">This command is used for the generation 2 chip authentication protocol specified in Appendix 11 Part B and is compliant with ISO/IEC 7816-4.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_100<span style="word-spacing: NaNpt"> </span>The command can be performed in the MF, DF Tachograph and DF Tachograph_G2, see also TCS_34.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_101<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="4%"/>
                  <col width="3%"/>
                  <col width="36%"/>
                  <col width="57%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘86h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Keys and protocol implicitly known</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc: length of subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘7Ch’ + L<span class="subscript">7C</span> + ‘80h’ + L<span class="subscript">80</span> + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded ephemeral public key value (see Appendix 11)</p>
                           <p class="tbl-norm">The VU shall send the data objects in this order.</p>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="4">
                           <p class="modref">
                              <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">As specified in ISO/IEC 7816-4</p>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="4">
                           <p class="modref">
                              <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
                           </p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_102<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="2%"/>
                  <col width="59%"/>
                  <col width="37%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘7Ch’ + L<span class="subscript">7C</span> + ‘81h’ + ‘08h’ + ‘XX..XXh’ + ‘82h’ + L<span class="subscript">82</span> + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded Dynamic Authentication Data: nonce and authentication token (see Appendix 11)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The card returns ‘
                                          <span class="boldface">6A80</span>
                                          ’ to indicate incorrect parameters in data field.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The card returns ‘
                                          <span class="boldface">6982</span>
                                          ’ if the External Authenticate command has not been performed successfully</div>
               </div>
            </div>
<p class="list">The response Dynamic Authentication Data object ‘7Ch’
                              </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">must be present if the operation is successful, i.e. the Status Words are ‘
                                          <span class="boldface">9000</span>
                                          ’,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">must be absent in case of an execution error or checking error, i.e. if the Status Words are in the range ‘
                                          <span class="boldface">6400</span>
                                          ’ — ‘
                                          <span class="boldface">6FFF</span>
                                          ’, and</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">may be absent in case of a warning, i.e. if the Status Words are in the range ‘
                                          <span class="boldface">6200</span>
                                          ’ — ‘
                                          <span class="boldface">63FF</span>
                                          ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-5864e52d-b25e-4801-bdb8-e1393216aa4e">3.5.11   <span class="boldface">
                  <span class="italics">MANAGE SECURITY ENVIRONMENT</span>
               </span>
            </p>
<p class="norm">This command is used to set a public key for authentication purpose.</p>
<p class="title-gr-seq-level-5" id="id-d05f4e59-326c-40fd-80f2-b5303529c831">3.5.11.1   <span class="boldface">
                  <span class="expanded">Generation 1 Command — Response pair</span>
               </span>
            </p>
<p class="norm">This command is compliant with ISO/IEC 7816-4. The use of this command is restricted regarding the related standard.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_103<span style="word-spacing: NaNpt"> </span>This command is only supported by a generation 1 tachograph application.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_104<span style="word-spacing: NaNpt"> </span>The key referenced in the MSE data field remains the current public key until the next correct MSE command, a DF is selected or the card is reset.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_105<span style="word-spacing: NaNpt"> </span>If the key referenced is not (already) present into the card, the security environment remains unchanged.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_106<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="8%"/>
                  <col width="29%"/>
                  <col width="56%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘22h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘C1h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P1: referenced key valid for all cryptographic operations</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B6h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">P2 (referenced data concerning Digital Signature)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc: length of subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘83h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag for referencing a public key in asymmetric cases</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘08h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of the key reference (key identifier)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#8-#15</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Key identifier as specified in Appendix 11</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_107<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                             <span class="boldface">9000</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the referenced key is not present into the card, the processing state returned is ‘
                                             <span class="boldface">6A88</span>
                                             ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some expected data objects are missing in the secure messaging format, the processing state ‘
                                             <span class="boldface">6987</span>
                                             ’ is returned. This can happen if the tag ‘83h’ is missing.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some data objects are incorrect, the processing state returned is ‘
                                             <span class="boldface">6988</span>
                                             ’. This can happen if the length of the key identifier is not ‘08h’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected key is considered corrupted, the processing state returned is ‘
                                             <span class="boldface">6400</span>
                                             ’ or ‘
                                             <span class="boldface">6581</span>
                                             ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-5" id="id-a9b48c1d-8a9b-46dc-aff7-c34a297b63bc">3.5.11.2   <span class="boldface">
                  <span class="expanded">Generation 2 Command — Response pairs</span>
               </span>
            </p>
<p class="norm">For the Generation 2 authentication the tachograph card supports the following MSE: Set command versions which are compliant with ISO/IEC 7816-4. These command versions are not supported for the Generation 1 authentication.</p>
<p class="title-gr-seq-level-6" id="id-8cbb36cc-1991-4718-b5f8-6ca7af69b2ef">3.5.11.2.1   <span class="boldface">
                  <span class="expanded">MSE:SET AT for Chip Authentication</span>
               </span>
            </p>
<p class="norm">The following MSE:SET AT command is used to select the parameters for the Chip Authentication that is performed by a subsequent General Authenticate command.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_108<span style="word-spacing: NaNpt"> </span>The command can be performed in the MF, DF Tachograph and DF Tachograph_G2, see also TCS_34.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_109<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">MSE:SET AT Command Message for Chip Authentication</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="640" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="1%"/>
                  <col width="17%"/>
                  <col width="80%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘22h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘41h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Set for internal authentication</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘A4h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Authentication</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc: length of subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘80h’ + ‘0Ah’ + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded cryptographic mechanism reference: Object Identifier of Chip Authentication (value only, Tag ‘06h’ is omitted).</p>
                           <p class="tbl-norm">See Appendix 1 for the values of object identifiers; the byte notation shall be used. See Appendix 11 for guidance on how to select one of these object identifiers.</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="title-gr-seq-level-6" id="id-4185080f-251e-4a38-ab03-bd93828d785f">3.5.11.2.2   <span class="boldface">
                  <span class="expanded">MSE:SET AT for VU Authentication</span>
               </span>
            </p>
<p class="norm">The following MSE:SET AT command is used to select the parameters and keys for the VU Authentication that is performed by a subsequent External Authenticate command.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_110<span style="word-spacing: NaNpt"> </span>The command can be performed in the MF, DF Tachograph and DF Tachograph_G2, see also TCS_34.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_111<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">MSE:SET AT Command Message for VU Authentication</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="640" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="1%"/>
                  <col width="17%"/>
                  <col width="80%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘22h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘81h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Set for external authentication</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘A4h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Authentication</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc: length of subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td rowspan="3" valign="top">
                           <p class="tbl-norm">#6-#(5+L)</p>
                        </td>
                        <td rowspan="3" valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘80h’ + ‘0Ah’ + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded cryptographic mechanism reference: Object Identifier of VU Authentication (value only, Tag ‘06h’ is omitted).</p>
                           <p class="tbl-norm">See Appendix 1 for the values of object identifiers; the byte notation shall be used. See Appendix 11 for guidance on how to select one of these object identifiers.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">‘83h’ + ‘08h’ + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded reference of the VU public key by the Certificate Holder Reference mentioned in its certificate.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">‘91h’ + L<span class="subscript">91</span> + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded compressed representation of the ephemeral public key of the VU that will be used during Chip Authentication (see Appendix 11)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="title-gr-seq-level-6" id="id-d03daecf-3dad-49b6-8353-fdb4ec9d4090">3.5.11.2.3   <span class="boldface">
                  <span class="expanded">MSE:SET DST</span>
               </span>
            </p>
<p class="norm">The following MSE:SET DST command is used to set a public key either</p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">for the verification of a signature that is provided in a subsequent PSO: Verify Digital Signature command or</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">for the signature verification of a certificate that is provided in a subsequent PSO: Verify Certificate command</div>
               </div>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_112<span style="word-spacing: NaNpt"> </span>The command can be performed in the MF, DF Tachograph and DF Tachograph_G2, see also TCS_33.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_113<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">MSE:SET DST Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="320" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="4%"/>
                  <col width="3%"/>
                  <col width="31%"/>
                  <col width="62%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘22h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘81h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Set for verification</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B6h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Digital Signature</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Lc: length of subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6-#(5+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘83h’ + ‘08h’ + ‘XX...XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded reference of a public key, i.e. the Certificate Holder Reference in the certificate of the public key (see Appendix 11)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="norm">For all command versions the response message structure and status words are given by:</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_114<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                                <span class="boldface">9000</span>
                                                ’. The protocol has been selected and initialised.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">
                                                ‘
                                                <span class="boldface">6A80</span>
                                                ’ indicates incorrect parameters in the command data field.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">
                                                ‘
                                                <span class="boldface">6A88</span>
                                                ’ indicates that referenced data (i.e. a referenced key) is not available.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: INSERTED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the currentAuthenticatedTime of the card is later than the Expiration Date of the selected public key, the processing state returned is <span class="boldface">
                                                   ‘6A88’.</span>
                  </div>
               </div>
            </div>
<div style="margin-left: 42pt; text-indent: -42pt">
               <p class="norm">
                  <span class="italics">Note:</span>
                  <span style="word-spacing: NaNpt"> </span>In the case of a MSE: SET AT for VU Authentication command, the referenced key is a VU_MA public key. The card shall set the VU_MA public key for use, if available in its memory, which matches the Certificate Holder Reference (CHR) given in the command data field (the card can identify VU_MA public keys by means of the certificate&#39;s CHA field). A card shall return ‘6A 88’ to this command in case only the VU_Sign public key or no public key of the Vehicle Unit is available. See the definition of the CHA field in Appendix 11 and of data type equipmentType in Appendix 1.</p>
            </div>
<p class="list">Similarly, in case an MSE: SET DST command referencing an EQT (i.e. a VU or a card) is sent to a control card, according to CSM_234 the referenced key is always an EQT_Sign key that has to be used for the verification of a digital signature. According to Figure 13 in Appendix 11, the control card will always have stored the relevant EQT_Sign public key. In some cases, the control card may have stored the corresponding EQT_MA public key. The control card shall always set the EQT_Sign public key for use when it receives an MSE: SET DST command.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-5a3731e0-3e6d-49a6-b86d-3f1b3ac6e76b">3.5.12   <span class="boldface">
                  <span class="italics">PSO: HASH</span>
               </span>
            </p>
<p class="norm">This command is used to transfer to the card the result of a hash calculation on some data. This command is used for the verification of digital signatures. The hash value is stored temporarily for the subsequent command PSO: Verify Digital Signature</p>
<p class="norm">This command is compliant with ISO/IEC 7816-8. The use of this command is restricted regarding the related standard.</p>
<p class="norm">Only the control card is required to support this command in the DF Tachograph and DF Tachograph_G2.</p>
<p class="norm">Other types of tachograph cards may or may not implement this command. The command may or may not be accessible in the MF.</p>
<p class="norm">The control card application generation 1 supports only SHA-1.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_115<span style="word-spacing: NaNpt"> </span>The temporarily stored hash value shall be deleted if a new hash value is computed by means of the PSO: HASH command, if a DF is selected, and if the tachograph card is reset.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_116<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="3%"/>
                  <col width="2%"/>
                  <col width="8%"/>
                  <col width="87%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Perform Security Operation</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘90h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Return Hash code</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘A0h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag: data field contains DOs relevant for hashing</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length Lc of the subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘90h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag for the hash code</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length L of the hash code:</p>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘14h’ in Generation 1 application (see Appendix 11 Part A)</p>
                           </div>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">‘20h’, ‘30h’ or ‘40h’ in Generation 2 application (see Appendix 11 Part B)</p>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#8-#(7+L)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Hash code</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_117<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some expected data objects (as specified above) are missing, the processing state ‘
                                          <span class="boldface">6987</span>
                                          ’ is returned. This can happen if one of the tag ‘90h’ is missing.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some data objects are incorrect, the processing state returned is ‘
                                          <span class="boldface">6988</span>
                                          ’. This error happens if the required tag is present but with a length different from ‘14h’ for SHA-1, ‘20h’ for SHA-256, ‘30h’ for SHA-384, ‘40h’ for SHA-512 (Generation 2 application).</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-91c1f6b1-b5b6-4772-b8b7-1ccd27c64622">3.5.13   <span class="boldface">
                  <span class="italics">PERFORM HASH of FILE</span>
               </span>
            </p>
<p class="norm">This command is not compliant with ISO/IEC 7816-8. Thus the CLA byte of this command indicates that there is a proprietary use of the PERFORM SECURITY OPERATION / HASH.</p>
<p class="norm">Only the driver card and the workshop card are required to support this command in the DF Tachograph and DF Tachograph_G2.</p>
<p class="norm">Other types of tachograph cards may or may not implement this command. If a company or control card implements this command, the command shall be implemented as specified in this chapter.</p>
<p class="norm">The command may or may not be accessible in the MF. If so, the command shall be implemented as specified in this chapter, i.e. shall not allow the calculation of a hash value, but terminate with a suitable error code.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_118<span style="word-spacing: NaNpt"> </span>The PERFORM HASH of FILE command is used to hash the data area of the currently selected transparent EF.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_119<span style="word-spacing: NaNpt"> </span>A tachograph card shall support this command only for the EFs that are listed in chapter 4 under the DF_Tachograph and DF_Tachograph_G2 with the following exception. A tachograph card shall not support the command for the EF Sensor_Installation_Data of DF Tachograph_G2..</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_120<span style="word-spacing: NaNpt"> </span>The result of the hash operation is stored temporarily in the card. It can then be used to get a digital signature of the file, using the PSO: COMPUTE DIGITAL SIGNATURE command.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_121<span style="word-spacing: NaNpt"> </span>The temporarily stored hash of file value shall be deleted if a new hash of file value is computed by means of the PERFORM HASH of FILE command, if a DF is selected, and if the tachograph card is reset.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_122<span style="word-spacing: NaNpt"> </span>The Tachograph Generation 1 application shall support SHA-1.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_123<span style="word-spacing: NaNpt"> </span>The Tachograph Generation 2 application shall support the SHA-2 algorithm (SHA-256, SHA-384 or SHA-512), specified by the cipher suite in Appendix 11 Part B for the card signature key Card_Sign.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_124<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="1%"/>
                  <col width="2%"/>
                  <col width="6%"/>
                  <col width="91%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘80h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Perform Security Operation</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘90h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag: Hash</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Algorithm implicitly known</p>
                           <p class="tbl-norm">For the Tachograph Generation 1 application: SHA-1</p>
                           <p class="tbl-norm">For the Tachograph Generation 2 application: SHA-2 algorithm (SHA-256, SHA-384 or SHA-512) defined by the cipher suite in Appendix 11 Part B for the card signature key Card_Sign</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_125<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the current EF does not allow this command (EF Sensor_Installation_Data in DF Tachograph_G2), the processing state ‘
                                          <span class="boldface">6985</span>
                                          ’ is returned.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected EF is considered corrupted (file attributes or stored data integrity errors), the processing state returned is ‘
                                          <span class="boldface">6400</span>
                                          ’ or ‘
                                          <span class="boldface">6581</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected file is not a transparent file or if there is no current EF, the processing state returned is ‘
                                          <span class="boldface">6986</span>
                                          ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-8135ba19-dc62-4639-b59e-74ae86a7a8df">3.5.14   <span class="boldface">
                  <span class="italics">PSO: COMPUTE DIGITAL SIGNATURE</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p class="norm">This command is used to compute the digital signature of previously computed hash code (see PERFORM HASH of FILE, §3.5.13).</p>
<p class="norm">Only the driver card and the workshop card are required to support this command in the DF Tachograph and DF Tachograph_G2.</p>
<p class="norm">Other types of tachograph cards may or may not implement this command. In case of the Generation 2 tachograph application, only the driver card and the workshop card have a generation 2 signature key, other cards are not able to successfully perform the command and terminate with a suitable error code.</p>
<p class="norm">The command may or may not be accessible in the MF. If the command is not accessible in the MF, it shall terminate with a suitable error code.</p>
<p class="norm">This command is compliant with ISO/IEC 7816-8. The use of this command is restricted regarding the related standard.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_126<span style="word-spacing: NaNpt"> </span>This command shall not compute a digital signature of previously computed hash code with the PSO: HASH command.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_127<span style="word-spacing: NaNpt"> </span>The card private key is used to compute the digital signature and is implicitly known by the card.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_128<span style="word-spacing: NaNpt"> </span>The Generation 1 tachograph application performs a digital signature using a padding method compliant with PKCS1 (see Appendix 11 for details).</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_129<span style="word-spacing: NaNpt"> </span>The Generation 2 tachograph application computes an elliptic curve based digital signature (see Appendix 11 for details).</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_130<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="3%"/>
                  <col width="11%"/>
                  <col width="84%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Perform Security Operation</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘9Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Digital signature to be returned</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘9Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag: data field contains data to be signed. As no data field is included, the data are supposed to be already present in the card (hash of file)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of the expected signature</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_131<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="7%"/>
                  <col width="8%"/>
                  <col width="31%"/>
                  <col width="55%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Signature of the previously computed hash</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the implicitly selected private key is considered as corrupted, the processing state returned is ‘
                                          <span class="boldface">6400</span>
                                          ’ or ‘
                                          <span class="boldface">6581</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the hash which was computed in a previous Perform Hash of File command is not available, the processing state returned is ‘
                                          <span class="boldface">6985</span>
                                          ’.</div>
               </div>
            </div>
<p class="title-gr-seq-level-4" id="id-16eb7d1f-e976-43e1-8346-e8883a61c309">3.5.15   <span class="boldface">
                  <span class="italics">PSO: VERIFY DIGITAL SIGNATURE</span>
               </span>
            </p>
<p class="norm">This command is used to verify the digital signature, provided as an input, whose hash is known to the card. The signature algorithm is implicitly known by the card.</p>
<p class="norm">This command is compliant with ISO/IEC 7816-8. The use of this command is restricted regarding the related standard.</p>
<p class="norm">Only the control card is required to support this command in the DF Tachograph and DF Tachograph_G2.</p>
<p class="norm">Other types of tachograph cards may or may not implement this command. The command may or may not be accessible in the MF.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_132<span style="word-spacing: NaNpt"> </span>The VERIFY DIGITAL SIGNATURE command always uses the public key selected by the previous Manage Security Environment MSE: Set DST command and the previous hash code entered by a PSO: HASH command.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_133<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="640" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="1%"/>
                  <col width="15%"/>
                  <col width="77%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Perform Security Operation</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘A8h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag: data field contains DOs relevant for verification</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length Lc of the subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘9Eh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Tag for Digital Signature</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#7 or</p>
                           <p class="tbl-norm">#7-#8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’ or</p>
                           <p class="tbl-norm">‘81 NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of digital signature (L is 2 bytes if the digital signature is longer than 127 bytes):</p>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">128 bytes coded in accordance with Appendix 11 Part A for Tachograph Generation 1 application.</p>
                           </div>
                           <div style="margin-left: 12pt; ">
                              <p class="item-none">Depending on the selected curve for Tachograph Generation 2 application (see Appendix 11 Part B).</p>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#(7+L)-#(6+L+NN)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NN</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Digital signature content</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_134<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="8%"/>
                  <col width="11%"/>
                  <col width="40%"/>
                  <col width="42%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the verification of the signature fails, the processing state returned is ‘
                                          <span class="boldface">6688</span>
                                          ’. The verification process is described in Appendix 11.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no public key is selected, the processing state returned is ‘
                                          <span class="boldface">6A88</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some expected data objects (as specified above) are missing, the processing state ‘
                                          <span class="boldface">6987</span>
                                          ’ is returned. This can happen if one of the required tag is missing.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If no hash code is available to process the command (as a result of a previous PSO: Hash command), the processing state returned is ‘
                                          <span class="boldface">6985</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If some data objects are incorrect, the processing state returned is ‘
                                          <span class="boldface">6988</span>
                                          ’. This can happen if one of the required data objects length is incorrect.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected public key is considered corrupted, the processing state returned is ‘
                                          <span class="boldface">6400</span>
                                          ’ or ‘
                                          <span class="boldface">6581</span>
                                          ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: INSERTED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the selected public key (used to verify the digital signature) has a CHA.LSB (CertificateHolderAuthorisation.equipmentType) that is not suitable for the digital signature verification according to Appendix 11, the processing state returned is ‘
                                          <span class="boldface">6985</span>
                                          ’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-53750434-05dc-445b-bae7-032493a3d661">3.5.16   <span class="boldface">
                  <span class="italics">PROCESS DSRC MESSAGE</span>
               </span>
            </p>
<p class="norm">This command is used to verify the integrity and authenticity of the DSRC message and to decipher the data communicated from a VU to a control authority or a workshop over the DSRC link. The card derives the encryption key and the MAC key used to secure the DSRC message as described in Appendix 11 Part B chapter 13.</p>
<p class="norm">Only the control card and the workshop card are required to support this command in the DF Tachograph_G2.</p>
<p class="norm">Other types of tachograph cards may or may not implement this command, but shall not have a DSRC master key. Therefore these cards cannot perform the command successfully, but terminate with a suitable error code.</p>
<p class="norm">The command may or may not be accessible in the MF and / or the DF Tachograph. If so, the command shall terminate with a suitable error code.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_135<span style="word-spacing: NaNpt"> </span>The DSRC master key is accessible only in the DF Tachograph_G2, i.e. the control and workshop card shall support a successful execution of the command only in the DF Tachograph_G2.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_136<span style="word-spacing: NaNpt"> </span>The command shall only decrypt the DSRC data and verify the cryptographic checksum, but not interpret the input data.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_137<span style="word-spacing: NaNpt"> </span>The order of the data objects in the command data field is fixed by this specification.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_138<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Command Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="480" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="3%"/>
                  <col width="2%"/>
                  <col width="18%"/>
                  <col width="77%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘80h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Proprietary CLA</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘2Ah’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Perform Security Operation</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘80h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Response data: plain value</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B0h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Command data: plain value encoded in BER-TLV and including SM DOs</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Lc</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘NNh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length Lc of the subsequent data field</p>
                        </td>
                     </tr>
                     <tr>
                        <td rowspan="4" valign="top">
                           <p class="tbl-norm">#6-#(5+L)</p>
                        </td>
                        <td rowspan="4" valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘87h’ + L<span class="subscript">87</span> + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded padding-content indicator byte followed by encrypted tachograph payload. For the padding-content indicator byte the value ‘00h’ (‘no further indication’ according to ISO/IEC 7816-4:2013 Table 52) shall be used. For the encryption mechanism see Appendix 11, Part B chapter 13.</p>
                           <p class="tbl-norm">Allowed values for the length L<span class="subscript">87</span> are the multiples of the AES block length plus 1 for the padding-content indicator byte, i.e. from 17 bytes up to and including 193 bytes.</p>
                           <p class="norm">
                              <span class="italics">Note:</span> See ISO/IEC 7816-4:2013 Table 49 for the SM data object with tag ‘87h’.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">‘81h’ + ‘10h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded Control Reference Template for Confidentiality nesting the concatenation of the following data elements (see Appendix 1 DSRCSecurityData and Appendix 11 Part B chapter 13):</p>
                           <div style="margin-left: 12pt; text-indent: -12pt; ">
                              <p class="item-none">— 4 byte time stamp</p>
                           </div>
                           <div style="margin-left: 12pt; text-indent: -12pt; ">
                              <p class="item-none">— 3 byte counter</p>
                           </div>
                           <div style="margin-left: 12pt; text-indent: -12pt; ">
                              <p class="item-none">— 8 byte VU serial number</p>
                           </div>
                           <div style="margin-left: 12pt; text-indent: -12pt; ">
                              <p class="item-none">— 1 byte DSRC master key version</p>
                           </div>
                           <p class="norm">
                              <span class="italics">Note:</span> See ISO/IEC 7816-4:2013 Table 49 for the SM data object with tag ‘81h’.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">‘8Eh’ + L<span class="subscript">8E</span> + ‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">DER-TLV encoded MAC over the DSRC message. For the MAC algorithm and calculation see Appendix 11, Part B chapter 13.</p>
                           <p class="norm">
                              <span class="italics">Note:</span> See ISO/IEC 7816-4:2013 Table 49 for the SM data object with tag ‘8Eh’.</p>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="4">
                           <p class="modref">
                              <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘00h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">As specified in ISO/IEC 7816-4</p>
                        </td>
                     </tr>
                     <tr>
                        <td colspan="4">
                           <p class="modref">
                              <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
                           </p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_139<span style="word-spacing: NaNpt"> </span>
                  <span class="boldface">Response Message</span>
               </p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="5%"/>
                  <col width="6%"/>
                  <col width="23%"/>
                  <col width="66%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">L</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Absent (in case of an error) or deciphered data (padding removed)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the card returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">
                                          ‘
                                          <span class="boldface">6A80</span>
                                          ’ indicates incorrect parameters in the command data field (also used in case the data objects are not sent in the specified order).</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">
                                          ‘
                                          <span class="boldface">6A88</span>
                                          ’ indicates that referenced data is not available, i.e. the referenced DSRC master key is not available.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">
                                          ‘
                                          <span class="boldface">6900</span>
                                          ’ indicates that the verification of the cryptographic checksum or the decryption of the data failed.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: INSERTED">▼M1</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">
                                          ‘
                                          <span class="boldface">6985</span>
                                          ’ indicates that the 4-byte time stamp provided in the command data field is earlier than cardValidityBegin or later than cardExpiryDate.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-2" id="id-01178bd9-6e5d-4009-a584-f76ea56e2a09">4.   <span class="boldface">TACHOGRAPH CARDS STRUCTURE</span>
            </p>
<p class="norm">This paragraph specifies the file structures of the Tachograph cards for storage of accessible data.</p>
<p class="norm">It does not specify card manufacturer dependent internal structures, such as e.g. file headers, nor storage and handling of data elements needed for internal use only such as ,, or.</p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_140<span style="word-spacing: NaNpt"> </span>A generation 2 tachograph card shall host the Master File MF and a generation 1 and a generation 2 tachograph application of the same type (e.g. driver card applications).</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_141<span style="word-spacing: NaNpt"> </span>A tachograph card shall support at least the minimum number of records specified for the corresponding applications and shall not support more records than the maximum number of records specified for the corresponding applications.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p class="list">The maximum and minimum numbers of records are specified in this chapter for the different applications. In version 2 of generation 2 driver and workshop cards, the generation 1 application shall support the maximum number of records specified in TCS_150 and TCS_158.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="list">For the security conditions used in the access rules throughout this chapter please refer to chapter 3.3. In general the access mode ‘read’ denotes the READ BINARY command with even and if supported odd INS byte with the exception of the EF Sensor_Installation_Data on the workshop card, see TCS_156 and TCS_160. The access mode ‘update’ denotes the Update Binary command with even and if supported odd INS byte and the access mode ‘select’ the SELECT command.</p>
<p class="title-gr-seq-level-3" id="id-e1bfcd60-06d6-4081-9e24-8e163596b2fb">4.1.   <span class="boldface">
                  <span class="boldface">Master File MF</span>
               </span>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_142<span style="word-spacing: NaNpt"> </span>After its personalisation, the master file MF shall have the following permanent file structure and file access rules:</p>
            </div>
<p class="norm">
               <span class="italics">Note:</span> The short EF identifier SFID is given as decimal number, e.g. the value 30 corresponds to 11110 in binary.</p>
<p class="list">
               
            </p>
<p class="list">The following abbreviation for the security condition is used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_143<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_144<span style="word-spacing: NaNpt"> </span>The Master File MF shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_145<span style="word-spacing: NaNpt"> </span>The elementary file EF DIR shall contain the following application related data objects: ‘61 08 4F 06 FF 54 41 43 48 4F 61 08 4F 06 FF 53 4D 52 44 54’</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_146<span style="word-spacing: NaNpt"> </span>The elementary file EF ATR/INFO shall be present if the tachograph card indicates in its ATR that it supports extended length fields. In this case the EF ATR/INFO shall contain the extended length information data object (DO‘7F66’) as specified in ISO/IEC 7816-4:2013 clause 12.7.1.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_147<span style="word-spacing: NaNpt"> </span>The elementary file EF Extended_Length shall be present if the tachograph card indicates in its ATR that it supports extended length fields. In this case the EF shall contain the following data object: ‘02 01 xx’ where the value ‘xx’ indicates whether extended length fields are supported for the T = 1 and / or T = 0 protocol.</p>
            </div>
<p class="list">The value ‘01’ indicates extended length field support for the T = 1 protocol.</p>
<p class="list">The value ‘10’ indicates extended length field support for the T = 0 protocol.</p>
<p class="list">The value ‘11’ indicates extended length field support for the T = 1 and the T = 0 protocol.</p>
<p class="title-gr-seq-level-3" id="id-2cf55db7-50b4-47a3-a06b-26be15fe241d">4.2.   <span class="boldface">
                  <span class="boldface">Driver card applications</span>
               </span>
            </p>
<p class="title-gr-seq-level-4" id="id-dcd5114e-beb8-4879-a79b-cd8fcbc7b6e8">4.2.1   <span class="boldface">
                  <span class="italics">Driver card application generation 1</span>
               </span>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_148<span style="word-spacing: NaNpt"> </span>After its personalisation, the driver card application generation 1 shall have the following permanent file structure and file access rules:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">The following abbreviations for the security conditions are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC2</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC3</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_149<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_150<span style="word-spacing: NaNpt"> </span>The driver card application generation 1 shall have the following data structure:</p>
            </div>
<p class="list">
                
               <span>
                  <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">
                     <span class="boldface">►(<span class="superscript">1</span>)(<span class="superscript">2</span>) M3</span>
                  </a>
               </span> 
                                          
                                        </p>
<p class="list">
               
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_151<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the driver card data structure must use for a generation 1 application:</p>
            </div>
<p class="list">
               
            </p>
<p class="title-gr-seq-level-4" id="id-da7f6be1-c021-40fe-89dd-1da71c0f5e84">4.2.2   <span class="boldface">
                  <span class="italics">Driver card application generation 2</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_152<span style="word-spacing: NaNpt"> </span>After its personalisation, the driver card application generation 2 shall have the following permanent file structure and file access rules:</p>
            </div>
<p class="title-gr-seq-level-4" id="id-448a5899-14fc-4377-9bc1-ecf0a7ca00be">
               <span class="italics">Notes:</span>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The short EF identifier SFID is given as decimal number, e.g. the value 30 corresponds to 11110 in binary.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">EF Application_Identification_V2, EF Places_Authentication, EF GNSS_Places_Authentication, EF Border_Crossings, EF Load_Unload_Operations, EF VU_Configuration and EF Load_Type_Entries are only present in version 2 of the generation 2 driver card.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">cardStructureVersion in EF Application_Identification is equal to {01 01} for version 2 of the generation 2 driver card, while it was equal to {01 00} for version 1 of the generation 2 driver card.</div>
               </div>
            </div>
<p class="list">
               
            </p>
<p class="list">The following abbreviations for the security condition are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC5</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="norm">For the Read Binary command with even INS byte: SM-C-MAC-G2 AND SM-R-ENC-MAC-G2</p>
                     <p class="norm">For the Read Binary command with odd INS byte (if supported): NEV</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_153<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_154<span style="word-spacing: NaNpt"> </span>The driver card application generation 2 shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_155<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the driver card data structure must use for a generation 2 application:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="19%"/>
                  <col width="40%"/>
                  <col width="40%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Min</span>
                           </p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Max</span>
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">1</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfEventsPerType</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">12</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">12</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">2</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfFaultsPerType</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">24</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">24</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">3</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCardVehicleRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">200</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">200</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">4</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCardPlaceRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">112</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">112</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">6</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CardActivityLengthRange</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">13776 Bytes</p>
                           <p class="tbl-norm">(56 days * 117 activity changes)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">13776 Bytes</p>
                           <p class="tbl-norm">(56 days * 117 activity changes)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">7</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCardVehicleUnitRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">200</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">200</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">8</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfGNSSADRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">336</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">336</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">9</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfSpecificConditionRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">112</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">112</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">10</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfBorderCrossingRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1120</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1120</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">11</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfLoadUnloadRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1624</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1624</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">12</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfLoadTypeEntryRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">336</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">336</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">13</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">VuConfigurationLengthRange</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-3" id="id-cfb880cb-48e4-4999-8d18-be3fcc349d26">4.3.   <span class="boldface">
                  <span class="boldface">Workshop card applications</span>
               </span>
            </p>
<p class="title-gr-seq-level-4" id="id-20f2994d-e780-44fa-bab2-2fc8a8ceb8a7">4.3.1   <span class="boldface">
                  <span class="italics">Workshop card application generation 1</span>
               </span>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_156<span style="word-spacing: NaNpt"> </span>After its personalisation, the workshop card application generation 1 shall have the following permanent file structure and file access rules:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">The following abbreviations for the security conditions are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC2</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC3</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC4</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="norm">For the READ BINARY command with even INS byte:</p>
                     <div class="list">(SM-C-MAC-G1 AND SM-R-ENC-MAC-G1) OR</div>
                     <div class="list">(SM-C-MAC-G2 AND SM-R-ENC-MAC-G2)</div>
                     <div class="list">For the READ BINARY command with odd INS byte (if supported): NEV</div>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_157<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_158<span style="word-spacing: NaNpt"> </span>The workshop card application generation 1 shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_159<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the workshop card data structure must use for a generation 1 application:</p>
            </div>
<p class="list">
               
            </p>
<p class="title-gr-seq-level-4" id="id-c24dc248-cddc-4318-917b-ee6f518f991f">4.3.2   <span class="boldface">
                  <span class="italics">Workshop card application generation 2</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_160<span style="word-spacing: NaNpt"> </span>After its personalisation, the workshop card application generation 2 shall have the following permanent file structure and file access rules.</p>
            </div>
<p class="title-gr-seq-level-4" id="id-77208f01-175c-479d-8aac-92e821ded323">
               <span class="italics">Notes:</span>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">The short EF identifier SFID is given as decimal number, e.g. the value 30 corresponds to 11110 in binary.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">EF Application_Identification_V2, EF Places_Authentication, EF GNSS_Places_Authentication, EF Border_Crossings, EF Load_Unload_Operations, EF Load_Type_Entries, EF VU_Configuration and EF Calibration_Add_Data are only present in version 2 of the generation 2 workshop card.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">cardStructureVersion in EF Application_Identification is equal to {01 01} for version 2 of the generation 2 workshop card, while it was equal to {01 00} for version 1 of the generation 2 workshop card.</div>
               </div>
            </div>
<p class="list">
               
            </p>
<p class="list">The following abbreviations for the security conditions are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC5</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="norm">For the Read Binary command with even INS byte: SM-C-MAC-G2 AND SM-R-ENC-MAC-G2</p>
                     <p class="norm">For the Read Binary command with odd INS byte (if supported): NEV</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_161<span style="word-spacing: NaNpt"> </span>All EFs structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_162<span style="word-spacing: NaNpt"> </span>The workshop card application generation 2 shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_163<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the workshop card data structure must use for a generation 2 application:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="2%"/>
                  <col width="22%"/>
                  <col width="32%"/>
                  <col width="44%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Min</span>
                           </p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Max</span>
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">1</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfEventsPerType</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">2</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfFaultsPerType</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">6</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">6</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">3</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCardVehicleRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">4</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCardPlaceRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">5</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCalibrationRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">255</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">255</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">6</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">CardActivityLengthRange</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">492 bytes (1 day * 240 activity changes)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">492 bytes (1 day *</p>
                           <p class="tbl-norm">240 activity changes)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">7</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCardVehicleUnitRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">8</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfGNSSADRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">24</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">24</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">9</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfSpecificConditionRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">10</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfBorderCrossingRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">11</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfLoadUnloadRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">12</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfLoadTypeEntryRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">13</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">VuConfigurationLengthRange</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-3" id="id-c13b62ce-4279-4a32-aa59-587e28652c6e">4.4.   <span class="boldface">
                  <span class="boldface">Control card applications</span>
               </span>
            </p>
<p class="title-gr-seq-level-4" id="id-2d9a590d-6703-4d02-b665-96e9d8f42df4">4.4.1   <span class="boldface">
                  <span class="italics">Control Card application generation 1</span>
               </span>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_164<span style="word-spacing: NaNpt"> </span>After its personalisation, the control card application generation 1 shall have the following permanent file structure and file access rules:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">The following abbreviations for the security conditions are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC2</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC3</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC6</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">EXT-AUT-G1 OR SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_165<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_166<span style="word-spacing: NaNpt"> </span>The control card application generation 1 shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_167<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the control card data structure must use for a generation 1 application:</p>
            </div>
<p class="list">
               
            </p>
<p class="title-gr-seq-level-4" id="id-38ea8d18-d135-4843-9e62-3e7d516d3fa9">4.4.2   <span class="boldface">
                  <span class="italics">Control card application generation 2</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_168<span style="word-spacing: NaNpt"> </span>After its personalisation, the control card application generation 2 shall have the following permanent file structure and file access rules.</p>
            </div>
<p class="title-gr-seq-level-4" id="id-1144bb78-b00d-4366-b586-acfd6eb36dad">
               <span class="italics">Notes:</span>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the short EF identifier SFID is given as decimal number, e.g. the value 30 corresponds to 11110 in binary,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">EF Application_Identification_V2, and EF VU_Configuration are only present in version 2 of the generation 2 control card,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">cardStructureVersion in EF Application_Identification is equal to {01 01} for version 2 of the generation 2 control card, while it was equal to {01 00} for version 1 of the generation 2 control card.</div>
               </div>
            </div>
<p class="norm">
               
            </p>
<p class="norm">The following abbreviations for the security condition are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC5</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="norm">For the Read Binary command with even INS byte: SM-C-MAC-G2 AND SM-R-ENC-MAC-G2</p>
                     <p class="norm">For the Read Binary command with odd INS byte (if supported): NEV</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_169<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_170<span style="word-spacing: NaNpt"> </span>The control card application generation2 shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">
               
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_171<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the control card data structure must use for a generation 2 application:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="53%"/>
                  <col width="20%"/>
                  <col width="20%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Min</span>
                           </p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Max</span>
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">7</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfControlActivityRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">230</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">520</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">13</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">VuConfigurationLengthRange</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-3" id="id-8a498eed-89da-4328-bd82-2a3d3994ff84">4.5.   <span class="boldface">
                  <span class="boldface">Company card applications</span>
               </span>
            </p>
<p class="title-gr-seq-level-4" id="id-eff3e295-9de4-44e9-bec1-9008f3814d00">4.5.1   <span class="boldface">
                  <span class="italics">Company card application generation 1</span>
               </span>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_172<span style="word-spacing: NaNpt"> </span>After its personalisation, the company card application generation 1 shall have the following permanent file structure and file access rules:</p>
            </div>
<p class="list">
               
            </p>
<p class="list">The following abbreviations for the security conditions are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC2</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC3</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC6</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">EXT-AUT-G1 OR SM-MAC-G1 OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_173<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_174<span style="word-spacing: NaNpt"> </span>The company card application generation 1 shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_175<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the company card data structure must use for a generation 1 application:</p>
            </div>
<p class="list">
               
            </p>
<p class="title-gr-seq-level-4" id="id-ba0dfbe1-6482-4a55-882a-fc54d8f62d9e">4.5.2   <span class="boldface">
                  <span class="italics">Company card application generation 2</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_176<span style="word-spacing: NaNpt"> </span>After its personalisation, the company card application generation 2 shall have the following permanent file structure and file access rules.</p>
            </div>
<p class="title-gr-seq-level-4" id="id-91650a31-6c5f-4ff6-a4b8-6751b5f93051">
               <span class="italics">Notes:</span>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the short EF identifier SFID is given as decimal number, e.g. the value 30 corresponds to 11110 in binary,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">EF Application_Identification_V2, and EF VU_Configuration are only present in version 2 of the generation 2 company card,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">cardStructureVersion in EF Application_Identification is equal to {01 01} for version 2 of the generation 2 company card, while it was equal to {01 00} for version 1 of the generation 2 company card.</div>
               </div>
            </div>
<p class="norm">
               
            </p>
<p class="norm">The following abbreviations for the security condition are used in this table:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC1</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">ALW OR SM-MAC-G2</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">
                        <span class="boldface">SC5</span>
                     </p>
                  </td>
                  <td valign="top">
                     <p class="norm">For the Read Binary command with even INS byte: SM-C-MAC-G2 AND SM-R-ENC-MAC-G2</p>
                     <p class="norm">For the Read Binary command with odd INS byte (if supported):NEV</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_177<span style="word-spacing: NaNpt"> </span>All EF structures shall be transparent.</p>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_178<span style="word-spacing: NaNpt"> </span>The company card application generation 2 shall have the following data structure:</p>
            </div>
<p class="list">
               
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">TCS_179<span style="word-spacing: NaNpt"> </span>The following values, used to provide sizes in the table above, are the minimum and maximum record number values the company card data structure must use for a generation 2 application:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="6%"/>
                  <col width="53%"/>
                  <col width="20%"/>
                  <col width="20%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Min</span>
                           </p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="hd-column">
                              <span class="boldface">Max</span>
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">8</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NoOfCompanyActivityRecords</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">230</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">520</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">n<span class="subscript">13</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">VuConfigurationLengthRange</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3072 Bytes</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
</body>
</html>