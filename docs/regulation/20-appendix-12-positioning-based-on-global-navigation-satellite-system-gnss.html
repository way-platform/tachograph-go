<!DOCTYPE html>
<html>
<head>

      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
      <title>Consolidated TEXT: 32016R0799 — EN — 21.08.2023</title>
      <link type="text/css" rel="stylesheet" href="http://publications.europa.eu/resource/presentation-style-sheet/clg/clg.css"/>
   
</head>
<body>
<p class="title-annex-1" id="id-083f1a73-7c6f-4ebb-b1ba-b9d21e699f61">Appendix 12</p>
<p class="title-gr-seq-level-1" id="id-b33af049-acd0-4152-bdc6-258eee86c5c7">
               <span class="boldface">POSITIONING BASED ON GLOBAL NAVIGATION SATELLITE SYSTEM (GNSS)</span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="3">
               <colgroup><col width="15%"/>
               <col width="85%"/>
               </colgroup><tbody><tr>
                  <td colspan="2">
                     <p class="title-toc" id="id-e328fb4b-8efa-4c79-b764-6a39d9c2204a">TABLE OF CONTENT</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">INTRODUCTION</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">1.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Scope</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">1.1.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">References</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">1.2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Acronyms and notations</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">BASIC CHARACTERISTICS OF THE GNSS RECEIVER</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">3.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">SENTENCES PROVIDED BY THE GNSS RECEIVER</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">VEHICLE UNIT WITH AN EXTERNAL GNSS FACILITY</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Configuration</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.1.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Main components and interfaces</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.1.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">External GNSS facility state at the end of production</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Communication between the external GNSS facility and the vehicle unit</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Communication Protocol</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Secure transfer of GNSS data</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.3</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Structure of the Read Record command</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.4</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Structure of the WriteRecord command</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.2.5</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Other commands</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.3.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Coupling, mutual authentication and session key agreement of the external GNSS facility with vehicle unit</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Error Handling</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.1</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Communication error with the external GNSS facility</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.2</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Breach of the physical integrity of the external GNSS facility</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.3</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Absence of position information from GNSS receiver</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">4.4.4</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">External GNSS facility certificate expired</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">5.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">VEHICLE UNIT WITHOUT AN EXTERNAL GNSS FACILITY</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">5.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Configuration</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">5.2.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Transfer of information from the GNSS receiver to the VU</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: DELETED">▼M3</a> —————</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">5.3.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Transfer of information from the VU to the GNSS receiver</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">5.4.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Error handling</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">5.4.1.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">Absence of position information from GNSS receiver</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">6.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">POSITION DATA PROCESSING AND RECORDING BY THE VU</p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">7.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">GNSS TIME CONFLICT</p>
                  </td>
               </tr>
               <!--transformed by post treatment--><tr>
                  <td>
                     <p class="modref">
                        <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
                     </p>
                  </td>
               </tr>
               <tr>
                  <td valign="top">
                     <p class="toc-item">8.</p>
                  </td>
                  <td valign="top">
                     <p class="toc-item">VEHICLE MOTION CONFLICT</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p class="title-gr-seq-level-2" id="id-66aa87b8-9ee0-414d-9354-7fc948854774">1.   <span class="boldface">INTRODUCTION</span>
            </p>
<p class="norm">This Appendix provides the technical requirements for the GNSS receiver and GNSS data used by the Vehicle Unit, including the protocols that must be implemented to assure the secure and correct data transfer of the positioning information.</p>
<p class="title-gr-seq-level-3" id="id-4f8e6a8c-ec48-494a-97a1-e7d44ba724c7">1.1.   <span class="boldface">
                  <span class="boldface">Scope</span>
               </span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_1</p>
                  </td>
                  <td valign="top">
                     <p class="norm">The Vehicle Unit shall collect location data from at least one GNSS satellite network.</p>
                     <p class="norm">The Vehicle Unit may be with or without an external GNSS facility as described in Figure 1:</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<p class="title-gr-seq-level-4" id="id-85d37c32-e847-4dc8-8ecd-f747797df384">1.1.1   <span class="boldface">
                  <span class="boldface">References</span>
               </span>
            </p>
<p class="norm">The following references are used in this part of this Appendix.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">NMEA</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">NMEA (National Marine Electronics Association) 0183 Interface Standard, V4.11</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-b8dd082f-d7d6-4416-8471-f9aab9ce8f0d">
               <span class="italics">Figure 1</span>
            </p>
<p class="title-gr-seq-level-4" id="id-4c7989e6-f8bc-484b-b2ba-3920a08ff674">
               <span class="boldface">Different configurations for GNSS receiver</span>
            </p>
<p class="title-gr-seq-level-3" id="id-cc805128-d840-44ac-8f76-659ba0eacaa4">1.2.   <span class="boldface">
                  <span class="boldface">Acronyms and notations</span>
               </span>
            </p>
<p class="norm">The following acronyms are used in this appendix:</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">DOP</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Dilution of Precision</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">EGF</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Elementary file GNSS Facility</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">EGNOS</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">European Geostationary Navigation Overlay Service</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNSS</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Global Navigation Satellite System</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GSA</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">GPS DOP and active satellites</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">HDOP</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Horizontal Dilution of Precision</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">ICD</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Interface Control Document</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">NMEA</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">National Marine Electronics Association</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">OSNMA</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Galileo Open Service Navigation Messages Authentication</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">PDOP</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Position Dilution of Precision</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">RMC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Recommended Minimum Specific</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">RTC</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Real Time Clock</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">SIS</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Signal in Space</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">VDOP</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Vertical Dilution of Precision</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">VU</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">Vehicle Unit</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p class="title-gr-seq-level-2" id="id-349f9bd9-34f5-4f8a-9ab6-48a323af8c8c">2.   <span class="boldface">BASIC CHARACTERISTICS OF THE GNSS RECEIVER</span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="norm">Regardless of the configuration of the Smart Tachograph with or without an external GNSS facility, the provision of accurate and reliable positioning information is an essential element of the effective operation of the Smart Tachograph. Therefore, it is appropriate to require its compatibility with the services provided by the Galileo and European Geostationary Navigation Overlay Service (EGNOS) programmes as set out in Regulation (EU) No 1285/2013 of the European Parliament and of the Council (<a href="#E0020" id="src.E0020">
                  <span class="superscript">13</span>
               </a>). The system established under the Galileo programme is an independent global satellite navigation system and the one established under the EGNOS programme is a regional satellite navigation system improving the quality of the Global Positioning System signal.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_2<span style="word-spacing: NaNpt"> </span>Manufacturers shall ensure that the GNSS receivers in the Smart Tachographs are compatible with the positioning services provided by the Galileo and the EGNOS systems. Manufacturers may also choose, in addition, compatibility with other satellite navigation systems.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3<span style="word-spacing: NaNpt"> </span>The GNSS receiver shall have the capability to support Navigation Messages Authentication on the Open Service of Galileo (OSNMA).</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3a<span style="word-spacing: NaNpt"> </span>The GNSS receiver shall perform a number of consistency checks in order to verify that the measurements computed by the GNSS receiver on the basis of the OSNMA data have resulted in the correct information about the position, velocity and data of the vehicle, and have therefore not been influenced by any external attack such as meaconing. These consistency checks shall consist, for instance, of:</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">detection of abnormal power emissions by means of combined monitoring of the Automatic Gain Control (AGC) and Carrier-to-Noise density ratio (C/N0),</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">pseudorange measurement consistency and Doppler measurement consistency over time, including the detection of abrupt measurement jumps,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">receiver autonomous integrity monitoring (RAIM) techniques, including the detection of inconsistent measurements with the estimated position,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">position and velocity checks, including abnormal position and velocity solutions, sudden jumps and behaviour not consistent with the dynamics of the vehicle,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">time and frequency consistency, including clock jumps and drifts that are not consistent with the receiver clock characteristics.</div>
               </div>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3b<span style="word-spacing: NaNpt"> </span>The European Commission shall develop and approve the following documents:</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">A Signal in Space Interface Control Document (SIS ICD), specifying in detail the OSNMA information transmitted in the Galileo signal.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">OSNMA Receiver Guidelines, providing the requirements and processes in the receivers to guarantee a secure implementation of OSNMA, as well as recommendations to enhance OSNMA performance.</div>
               </div>
            </div>
<p class="list">GNSS receivers fitted in tachographs, either internal or external, shall be constructed in accordance with the SIS ICD and the OSNMA receiver guidelines.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3c<span style="word-spacing: NaNpt"> </span>The GNSS receiver shall provide position messages, called authenticated position messages in this Annex and its Appendixes, which are elaborated using only satellites from which the authenticity of the navigation messages has been successfully verified.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3d<span style="word-spacing: NaNpt"> </span>The GNSS receiver shall also provide standard position messages, elaborated using the satellites in view, regardless whether they are authenticated or not.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3e<span style="word-spacing: NaNpt"> </span>The GNSS receiver shall use the VU Real Time Clock (RTC) as time reference for the time synchronisation necessary for OSNMA.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3f<span style="word-spacing: NaNpt"> </span>The VU RTC time shall be provided to the GNSS receiver by the VU.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_3g<span style="word-spacing: NaNpt"> </span>The maximal time drift specified in requirement 41 of Annex IC, shall be provided to the GNSS receiver by the VU, along with the VU RTC time.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p class="title-gr-seq-level-2" id="id-37d85507-eecc-45e9-bab8-bf8fcd6022d8">3.   <span class="boldface">SENTENCES PROVIDED BY THE GNSS RECEIVER</span>
            </p>
<p class="norm">This section describes the sentences used in the functioning of the Smart Tachograph, for transmitting standard and authenticated position messages. This section is valid both for the configuration of the Smart Tachograph with or without an external GNSS facility.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_4</p>
                  </td>
                  <td valign="top">
                     <p class="norm">The standard position data is based on the NMEA sentence Recommended Minimum Specific (RMC) GNSS Data, which contains the Position information (Latitude, Longitude), Time in UTC format (hhmmss.ss), and Speed Over Ground in Knots plus additional values.</p>
                     <p class="norm">The format of the RMC sentence is the following (as from NMEA V4.11 standard):</p>
                     <p class="norm">
                         
                        <span class="italics">Figure 2</span> 
                        <br/> 
                        <span class="boldface">Structure of the RMC sentence</span> 
                     </p>
                     <p class="norm">$--RMC,hhmmss.ss,A,llll.ll,a,yyyyy.yy,a,x.x,x.x,xxxx,x.x,a,a,a*hh</p>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(1)<span style="word-spacing: 18pt"> </span>Time (UTC)</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(2)<span style="word-spacing: 18pt"> </span>Status, A= Valid position, V= Warning</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(3)<span style="word-spacing: 18pt"> </span>Latitude</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(4)<span style="word-spacing: 18pt"> </span>N or S</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(5)<span style="word-spacing: 18pt"> </span>Longitude</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(6)<span style="word-spacing: 18pt"> </span>E or W</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(7)<span style="word-spacing: 18pt"> </span>Speed over ground in knots</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(8)<span style="word-spacing: 18pt"> </span>Track made good, degrees true</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(9)<span style="word-spacing: 18pt"> </span>Date, ddmmyy</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(10)<span style="word-spacing: 18pt"> </span>Magnetic Variation, degrees</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(11)<span style="word-spacing: 18pt"> </span>E or W</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(12)<span style="word-spacing: 18pt"> </span>FAA Mode Indicator</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(13)<span style="word-spacing: 18pt"> </span>Navigational status</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(14)<span style="word-spacing: 18pt"> </span>Checksum</p>
                     </div>
                     <p class="norm">The Navigational status is optional and may not be present in the RMC sentence.</p>
                     <p class="norm">The Status gives indication if the GNSS signal is available. Until the value of the Status is not set to ‘A’, the received data (e.g., on Time or Latitude/Longitude) cannot be used to record the position of the vehicle in the VU.</p>
                     <p class="norm">The resolution of the position is based on the format of the RMC sentence described above. The first part of the fields 3) and 5) are used to represent the degrees. The rest are used to represent the minutes with three decimals. So the resolution is 1/1 000  of minute or 1/60 000  of degree (because one minute is 1/60 of a degree).</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_4a</p>
                  </td>
                  <td valign="top">
                     <p class="norm">The authenticated position data is based on a NMEA-like sentence, Authenticated Minimum Specific (AMC) Data, which contains the Position information (Latitude, Longitude), Time in UTC format (hhmmss.ss), and Speed Over Ground in Knots plus additional values.</p>
                     <p class="norm">The format of the AMC sentence is the following (as from NMEA V4.11 standard, except for value number 2):</p>
                     <p class="norm">
                         
                        <span class="italics">Figure 3</span> 
                        <br/> 
                        <span class="boldface">Structure of the AMC sentence</span> 
                     </p>
                     <p class="norm">$--AMC,hhmmss.ss,A,llll.ll,a,yyyyy.yy,a,x.x,x.x,xxxx,x.x,a,a,a*hh</p>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(1)<span style="word-spacing: 18pt"> </span>Time (UTC)</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(2)<span style="word-spacing: 18pt"> </span>Status, A=Authenticated position (established using at least 4 satellites from which the authenticity of the navigation messages has been successfully verified), J=jamming or O=other GNSS attack in the absence of failed authentication of navigation messages (by implemented consistency checks according to GNS_3a), F=failed authentication of navigation messages (as detected by OSNMA verifications specified in the documents referred to in GNS_3b), V=Void (authenticated position is not available for any other reason)</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(3)<span style="word-spacing: 18pt"> </span>Latitude</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(4)<span style="word-spacing: 18pt"> </span>N or S</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(5)<span style="word-spacing: 18pt"> </span>Longitude</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(6)<span style="word-spacing: 18pt"> </span>E or W</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(7)<span style="word-spacing: 18pt"> </span>Speed over ground in knots</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(8)<span style="word-spacing: 18pt"> </span>Track made good, degrees true</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(9)<span style="word-spacing: 18pt"> </span>Date, ddmmyy</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(10)<span style="word-spacing: 18pt"> </span>Magnetic Variation, degrees</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(11)<span style="word-spacing: 18pt"> </span>E or W</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(12)<span style="word-spacing: 18pt"> </span>FAA Mode Indicator</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(13)<span style="word-spacing: 18pt"> </span>Navigational status</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(14)<span style="word-spacing: 18pt"> </span>Checksum</p>
                     </div>
                     <p class="norm">The Navigational status is optional and may not be present in the AMC sentence.</p>
                     <p class="norm">The Status gives indication if an authenticated GNSS position is available, if an attack on the GNSS signals has been detected, if authentication of navigation messages has failed, or if GNSS position is void. When the value of the Status is not set to ‘A’, the received data (e.g. Time or Latitude/Longitude) are considered to be not valid, and may not be used to record the position of the vehicle in the VU. When the value of the Status is set to ‘J’ (jamming), ‘O’ (other GNSS attack), or ‘F’ (failed authentication of navigation messages), a GNSS anomaly event shall be recorded in the VU, as defined in Annex IC and Appendix 1 (EventFaultCode).</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_5</p>
                  </td>
                  <td valign="top">
                     <p class="norm">The Vehicle Unit shall store in the VU database the position information for latitude and longitude with a resolution of 1/10 of minute or 1/600 of a degree as described in Appendix 1 for type GeoCoordinates.</p>
                     <p class="norm">The GPS DOP and active satellites (GSA) command, as from NMEA V4.11 standard, can be used by the VU to determine and record the signal availability and accuracy of standard positions. In particular the HDOP is used to provide an indication on the level of accuracy of the recorded location data (see 4.2.2). The VU will store the value of the Horizontal Dilution of Precision (HDOP) calculated as the minimum of the HDOP values collected on the available GNSS systems.</p>
                     <p class="norm">The GNSS Id. indicates the corresponding NMEA Id. for every GNSS constellation and Satellite-Based Augmentation System (SBAS).</p>
                     <p class="norm">
                         
                        <span class="italics">Figure 4</span> 
                        <br/> 
                        <span class="boldface">Structure of the GSA sentence (standard positions)</span> 
                     </p>
                     <p class="norm">$--GSA,a,a,x,x,x,x,x,x,x,x,x,x,x,x,x.x,x.x,x.x,a*hh</p>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(1)<span style="word-spacing: 18pt"> </span>Selection mode</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(2)<span style="word-spacing: 18pt"> </span>Mode</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(3)<span style="word-spacing: 18pt"> </span>ID of 1<span class="superscript">st</span> satellite used for fix</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(4)<span style="word-spacing: 18pt"> </span>ID of 2<span class="superscript">nd</span> satellite used for fix</p>
                     </div>
                     <p class="norm">…</p>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(14)<span style="word-spacing: 18pt"> </span>ID of 12th satellite used for fix</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(15)<span style="word-spacing: 18pt"> </span>PDOP</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(16)<span style="word-spacing: 18pt"> </span>HDOP</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(17)<span style="word-spacing: 18pt"> </span>VDOP</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(18)<span style="word-spacing: 18pt"> </span>System ID</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(19)<span style="word-spacing: 18pt"> </span>Checksum</p>
                     </div>
                     <p class="norm">The System ID is optional and may not be present in the GSA sentence.</p>
                     <p class="norm">Similarly, the NMEA-like sentence authenticated active satellites (ASA) command can be used by the VU to determine and record the signal availability and accuracy of authenticated positions. Values 1 to 18 are defined in NMEA V4.11 standard.</p>
                     <p class="norm">
                         
                        <span class="italics">Figure 5</span> 
                        <br/> 
                        <span class="boldface">Structure of the ASA sentence (authenticated positions)</span> 
                     </p>
                     <p class="norm">$--ASA,a,a,x,x,x,x,x,x,x,x,x,x,x,x,x.x,x.x,x.x,a*hh</p>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(1)<span style="word-spacing: 18pt"> </span>Selection mode</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(2)<span style="word-spacing: 18pt"> </span>Mode</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(3)<span style="word-spacing: 18pt"> </span>ID of 1<span class="superscript">st</span> satellite used for fix</p>
                     </div>
                     <div style="margin-left: 30pt; text-indent: -30pt">
                        <p class="norm">(4)<span style="word-spacing: 18pt"> </span>ID of 2<span class="superscript">nd</span> satellite used for fix</p>
                     </div>
                     <p class="norm">…</p>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(14)<span style="word-spacing: 18pt"> </span>ID of 12<span class="superscript">th</span> satellite used for fix</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(15)<span style="word-spacing: 18pt"> </span>PDOP</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(16)<span style="word-spacing: 18pt"> </span>HDOP</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(17)<span style="word-spacing: 18pt"> </span>VDOP</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(18)<span style="word-spacing: 18pt"> </span>System ID</p>
                     </div>
                     <div style="margin-left: 36pt; text-indent: -36pt">
                        <p class="norm">(19)<span style="word-spacing: 18pt"> </span>Checksum</p>
                     </div>
                     <p class="norm">The System ID is optional and may not be present in the ASA sentence.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_6</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">When an external GNSS facility is used, the <span class="italics">GSA</span> sentence shall be stored in the GNSS Secure Transceiver with record number ‘02’ to ‘06’, and the ASA sentence shall be stored with record number ‘12’ to ‘16’.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_7</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">The maximum size of the sentences (e.g., RMC, AMC, GSA, ASA or others), which can be used for the sizing of the read record command shall be 85 bytes (see Table 1).</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-2" id="id-28c5eef0-ca64-4dd3-a8b5-84f88428f88c">4.   <span class="boldface">VEHICLE UNIT WITH AN EXTERNAL GNSS FACILITY</span>
            </p>
<p class="title-gr-seq-level-3" id="id-dbe469fc-d63e-4d21-b653-2a0d6f8ecf0c">4.1.   <span class="boldface">
                  <span class="boldface">Configuration</span>
               </span>
            </p>
<p class="title-gr-seq-level-4" id="id-6e182289-53d2-4c20-a8f9-97bdfae6d4bc">4.1.1   <span class="boldface">
                  <span class="italics">Main components and interfaces</span>
               </span>
            </p>
<p class="norm">In this configuration, the GNSS receiver is a part of the external GNSS facility.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_8<span style="word-spacing: NaNpt"> </span>The external GNSS facility must be powered with a specific vehicle interface.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_9<span style="word-spacing: NaNpt"> </span>The external GNSS facility shall consist of the following components (see Figure 6):</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>(a) </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">A commercial GNSS receiver to provide the position data through the GNSS data interface. For example, the GNSS data interface can be NMEA standard V4.11 where the GNSS receiver acts as a talker and transmits NMEA sentences to the GNSS Secure Transceiver with a frequency of 1Hz for the pre-defined set of NMEA and NMEA-like sentences, which must include at least the RMC, AMC, GSA and ASA sentences. The implementation of the GNSS data interface is a choice of the manufacturers of the external GNSS facility.</p>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>(b) </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">A transceiver unit (GNSS Secure Transceiver) with the capability to support standard ISO/IEC 7816-4:2013 (see 4.2.1) to communicate with the vehicle unit and support the GNSS data interface to the GNSS receiver. The unit is provided with a memory to store the identification data of the GNSS receiver and external GNSS facility.</p>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>(c) </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">An enclosure system with tamper detection function, which encapsulates both the GNSS receiver and the GNSS Secure Transceiver. The tamper detection function shall implement the security protection measures as requested in the Protection Profile of the Smart Tachograph.</p>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>(d) </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">A GNSS antenna installed on the vehicle and connected to the GNSS receiver through the enclosure system.</p>
               </div>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_10<span style="word-spacing: NaNpt"> </span>The external GNSS facility has at least the following external interfaces:</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>(a) </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">the interface to the GNSS antenna installed on the vehicle truck, if an external antenna is used.</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>(b) </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">the interface to the Vehicle Unit.</p>
               </div>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_11<span style="word-spacing: NaNpt"> </span>In the VU, the VU Secure Transceiver is the other end of the secure communication with the GNSS Secure Transceiver and it must support ISO/IEC 7816-4:2013 for the connection to the external GNSS facility.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_12<span style="word-spacing: NaNpt"> </span>For the physical layer of the communication with the external GNSS facility, the vehicule unit shall support ISO/IEC 7816-12:2005 or another standard able to support ISO/IEC 7816-4:2013. (see 4.2.1).</p>
            </div>
<p class="title-gr-seq-level-4" id="id-ea56daeb-bbf3-4744-973e-615487d2070d">4.1.2   <span class="boldface">
                  <span class="italics">External GNSS facility state at the end of production</span>
               </span>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_13<span style="word-spacing: NaNpt"> </span>The external GNSS facility shall store the following values in the non-volatile memory of the GNSS Secure Transceiver when it leaves the factory:</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the EGF_MA key pair and corresponding certificate,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the MSCA_VU-EGF certificate containing the MSCA_VU-EGF.PK public key to be used for verification of the EGF_MA certificate,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the EUR certificate containing the EUR.PK public key to be used for verification of the MSCA_VU-EGF certificate,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the EUR certificate whose validity period directly precedes the validity period of the EUR certificate to be used to verify the MSCA_VU-EGF certificate, if existing,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the link certificate linking these two EUR certificates, if existing,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">the extended serial-number of the external GNSS facility,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">operating system identifier of the GNSS facility,</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">type approval number of the external GNSS facility;</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">Identifier of the security component of the external GNSS module.</div>
               </div>
            </div>
<p class="title-gr-seq-level-3" id="id-041e3bf8-7630-4769-a077-1fee0f8fc254">4.2.   <span class="boldface">
                  <span class="boldface">Communication between the external GNSS facility and the vehicle unit</span>
               </span>
            </p>
<p class="title-gr-seq-level-4" id="id-b48b8672-4e23-438a-af0c-d2a37e9241fb">4.2.1   <span class="boldface">
                  <span class="italics">Communication Protocol</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_14<span style="word-spacing: NaNpt"> </span>The communication protocol between the external GNSS facility and the vehicle unit shall support the following functions:</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>1. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The collection and distribution of GNSS data (e.g., position, timing, speed),</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>2. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The collection of the configuration data of the external GNSS facility,</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>3. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The management protocol to support the coupling, mutual authentication and session key agreement between the external GNSS facility and the VU,</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>4. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The transmission to the external GNSS facility of the VU RTC time and of the maximal difference between true time and the VU RTC time.</p>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_15<span style="word-spacing: NaNpt"> </span>The communication protocol shall be based on standard ISO/IEC 7816-4:2013 with the VU Secure Transceiver playing the master role and the GNSS Secure Transceiver playing the slave role. The physical connection between the external GNSS facility and the vehicule unit is based on ISO/IEC 7816-12:2005 or another standard able to support ISO/IEC 7816-4:2013</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_16<span style="word-spacing: NaNpt"> </span>In the communication protocol, extended length fields shall not be supported.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_17<span style="word-spacing: NaNpt"> </span>The communication protocol of ISO 7816 (both *-4:2013 and *-12:2005) between the external GNSS facility and the VU shall be set to T = 1.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_18<span style="word-spacing: NaNpt"> </span>Regarding the functions 1) the collection and distribution of GNSS data and 2) the collection of the configuration data of the external GNSS facility and 3) management protocol, the GNSS Secure Transceiver shall simulate a smart card with a file system architecture composed by a Master File (MF), a Dedicated File (DF) with Application Identifier specified in Appendix 1 chapter 6.2 (‘FF 44 54 45 47 4D’) and with 3 EFs containing certificates and one single Elementary File (EF.EGF) with file identifier equal to ‘2F2F’ as described in Table 1.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_18a<span style="word-spacing: NaNpt"> </span>Regarding the function 4) the transmission to the external GNSS facility of the VU RTC time and of the maximal difference between true time and the VU RTC time, the GNSS Secure Transceiver shall use an EF (EF VU) in the same DF with file identifier equal to ‘2F30’ as described in Table 1.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_19<span style="word-spacing: NaNpt"> </span>The GNSS Secure Transceiver shall store the data coming from the GNSS receiver and the configuration in the EF.EGF. This is a linear, variable-length record file with an identifier equal to ‘2F2F’ in hexadecimal format.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_19a<span style="word-spacing: NaNpt"> </span>The GNSS Secure Transceiver shall store the data coming from the VU in the EF VU. This is a linear, fixed-length record file with an identifier equal to ‘2F30’ in hexadecimal format.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_20<span style="word-spacing: NaNpt"> </span>The GNSS Secure Transceiver shall use a memory to store the data and be able to perform as many read/write cycles as needed during a lifetime of at least 15 years. Apart from this aspect, the internal design and implementation of the GNSS Secure Transceiver is left to the manufacturers.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32018R0502" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32018R0502: REPLACED">▼M1</a>
            </p>
<p class="list">The mapping of record numbers and data is provided in Table 1. Note that there are five GSA sentences for the GNSS constellations and Satellite-Based Augmentation System (SBAS).</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_21<span style="word-spacing: NaNpt"> </span>The file structure is provided in Table 1. For the access conditions (ALW, NEV, SM-MAC) see Appendix 2 chapter 3.5.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <p class="title-table" id="id-1f17bf3f-21b2-4fb1-90b1-2c0e166584fd">
                  <span class="italics">Table 1</span>
               </p>
               <p class="title-table" id="id-24c1e2a3-eed6-43a5-9aaf-28897809a5c7">
                  <span class="boldface">File Structure</span>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="11%"/>
                  <col width="13%"/>
                  <col width="11%"/>
                  <col width="48%"/>
                  <col width="17%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td style="font-weight: bold" valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td colspan="3" style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Access conditions</p>
                        </td>
                     </tr>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">File</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">File ID</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Read</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Update</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Encrypted</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MF</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">3F00</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF.ICC</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0002</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NEV</p>
                           <p class="tbl-norm">(by VU)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">DF GNSS Facility</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">0501</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NEV</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF EGF_MACertificate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">C100</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NEV</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF CA_Certificate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">C108</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NEV</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF Link_Certificate</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">C109</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">ALW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NEV</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF EGF</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2F2F</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">SM-MAC</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">NEV</p>
                           <p class="tbl-norm">(by VU)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF VU</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2F30</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">SM-MAC</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">SM-MAC</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">No</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="78%"/>
                  <col width="11%"/>
                  <col width="1%"/>
                  <col width="1%"/>
                  <col width="9%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">File / Data element</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Record no</p>
                        </td>
                        <td colspan="2" style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Size (bytes)</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Default values</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-norm">Min</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Max</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MF</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-norm">552</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1031</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF.ICC</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">sensorGNSSSerialNumber</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">DF GNSS Facility</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">612</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">1023</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF EGF_MACertificate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">204</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">341</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EGFCertificate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-norm">204</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">341</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">{00..00}</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF CA_Certificate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">204</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">341</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">MemberStateCertificate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-norm">204</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">341</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">{00..00}</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF Link_Certificate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">204</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="tbl-right">
                              <span class="italics">341</span>
                           </p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">LinkCertificate</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="tbl-norm">204</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">341</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">{00..00}</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF EGF</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">RMC NMEA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;01&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">1st GSA NMEA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;02&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">2nd GSA NMEA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;03&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">3rd GSA NMEA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;04&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">4th GSA NMEA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;05&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">5th GSA NMEA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;06&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Extended serial-number of the external GNSS facility defined in Appendix 1 as SensorGNSSSerialNumber.</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;07&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Operating system identifier of the GNSS Secure Transceiver defined in Appendix 1 as SensorOSIdentifier.</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;08&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Type approval number of the external GNSS facility defined in Appendix 1 as SensorExternalGNSSApprovalNumber.</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;09&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">16</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">16</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Identifier of the security component of the external GNSS facility defined in Appendix 1 as SensorExternalGNSSSCIdentifier</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;10&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">8</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">AMC Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;11&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">1st ASA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;12&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">2nd ASA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;13&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">3rd ASA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;14&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">4th ASA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;15&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">5th ASA Sentence</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;16&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">85</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">RFU – Reserved for Future Use</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">From &#39;17&#39; to &#39;FD&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">EF VU</p>
                        </td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                        <td valign="top">
                           <p class="normal"> </p>
                           <div>
                        </div></td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">VuRtcTime (see Appendix 1)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;01&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">4</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">{00..00}</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">VuGnssMaximalTimeDifference (see Appendix 1)</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">&#39;02&#39;</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">{00..00}</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-05514b9f-8201-443a-8933-258cc5c5eea7">4.2.2   <span class="boldface">
                  <span class="italics">Secure transfer of GNSS data</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_22<span style="word-spacing: NaNpt"> </span>The secure transfer of GNSS position data, VU RTC time and maximal time difference between true time and the VU RTC time shall be allowed only in the following conditions:</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>1. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The coupling process has been completed as described in Appendix 11. Common security mechanisms.</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>2. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The periodic mutual authentication and session key agreement between the VU and the external GNSS facility also described in Appendix 11. Common security mechanisms has been executed with the indicated frequency.</p>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_23<span style="word-spacing: NaNpt"> </span>Every T seconds, where T is a value lower or equal to 20, unless coupling or mutual authentication and session key agreement takes place, the VU requests from the external GNSS facility the position information on the basis of the following flow:</p>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>1. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The VU requests position data from the External GNSS facility together with Dilution of Precision data (from the GSA and ASA sentences). The VU Secure Transceiver shall use the ISO/IEC 7816-4:2013 SELECT and READ RECORD(S) commands in secure messaging authentication-only mode as described in section 11.5 of Appendix 11 with the file identifier ‘2F2F’ and RECORD number equal to ‘01’ for RMC NMEA sentence, ‘02’,‘03’,‘04’,‘05’,‘06’ for GSA NMEA sentence, ‘11’ for AMC sentence, and ‘12’,‘13’,‘14’,‘15’,‘16’ for ASA sentence.</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>2. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The last position data received is stored in the EF with identifier ‘2F2F’ and the records described in Table 1 in the GNSS secure transceiver as the GNSS secure transceiver receives NMEA data with a frequency of at least 1 Hz from the GNSS receiver through the GNSS data interface.</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>3. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The GNSS Secure Transceiver sends the response to the VU Secure Transceiver by using the APDU response message in secure messaging authentication-only mode as described in section 11.5 of Appendix 11.</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>4. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The VU Secure Transceiver checks the authenticity and integrity of the received response. In case of positive outcome, the position data is transferred to the VU processor through the GNSS data interface.</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>5. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The VU processor checks the received data extracting the information (e.g., latitude, longitude, time) from the RMC NMEA sentence. The RMC NMEA sentence includes the information if the non-authenticated position is valid. If the non-authenticated position is valid, the VU processor also extracts the values of HDOP from GSA NMEA sentences and calculates the minimum value on the available satellite systems (i.e., when the fix is available).</p>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>6. </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">The VU processor also extracts the information (e.g., latitude, longitude, time) from the AMC sentence. The AMC sentence includes the information if the authenticated position is not valid or GNSS signal has been attacked. If the position is valid, the VU processor also extracts the values of HDOP from ASA sentences and calculates the minimum value on the available satellite systems (i.e., when the fix is available).</p>
               </div>
            </div>
<div style="margin-left: 54pt; text-indent: -54pt">
               <p class="norm">GNS_23a<span style="word-spacing: NaNpt"> </span>The VU shall also write VU RTC time and maximal time difference between true time and the VU RTC time as needed, by using the ISO/IEC 7816-4:2013 SELECT and WRITE RECORD(S) commands in secure messaging authentication-only mode as described in section 11.5 of Appendix 11 with the file identifier ‘2F30’ and RECORD number equal to ‘01’ for VuRtcTime and ‘02’ for MaximalTimeDifference.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-83a36135-5294-42ae-9f7a-2f4a1c61de8a">4.2.3   <span class="boldface">
                  <span class="italics">Structure of the Read Record command</span>
               </span>
            </p>
<p class="norm">This section describes in detail the structure of the Read Record command. Secure messaging (authentication-only mode) is added as described in Appendix 11 Common security mechanisms.</p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_24<span style="word-spacing: NaNpt"> </span>The command shall support the Secure Messaging authentication-only-mode, see Appendix 11.</p>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_25<span style="word-spacing: NaNpt"> </span>Command Message</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="4%"/>
                  <col width="7%"/>
                  <col width="23%"/>
                  <col width="66%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">CLA</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘0Ch’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Secure messaging asked.</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">INS</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘B2h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Read Record</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Record number (‘00’ references the current record)</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">P2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘04h’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Read the record with the record number indicated in P1</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">Le</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">1</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Length of data expected. Number of Bytes to be read.</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_26<span style="word-spacing: NaNpt"> </span>The record referenced in P1 becomes the current record.</p>
            </div>
<p>
               <br/>
            </p>
<div class="centered">
               <p>
                  <br/>
               </p>
               <table width="240" border="1" cellpadding="2" cellspacing="0">
                  <colgroup><col width="9%"/>
                  <col width="11%"/>
                  <col width="41%"/>
                  <col width="39%"/>
                  </colgroup><tbody>
                     <tr>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Byte</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Length</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Value</p>
                        </td>
                        <td style="font-weight: bold" valign="top">
                           <p class="tbl-norm">Description</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">#1-#X</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">X</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XX..XXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Data read</p>
                        </td>
                     </tr>
                     <tr>
                        <td valign="top">
                           <p class="tbl-norm">SW</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">2</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">‘XXXXh’</p>
                        </td>
                        <td valign="top">
                           <p class="tbl-norm">Status Words (SW1,SW2)</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is successful, the GNSS secure transceiver returns ‘
                                          <span class="boldface">9000</span>
                                          ’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the current file is not record oriented, the GNSS secure transceiver returns <span class="boldface">
                                             ‘6981’
                                          </span>.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the command is used with P1 = ‘00’ but there is no current EF the GNSS secure transceiver returns <span class="boldface">
                                             ‘6986’
                                          </span> (command not allowed).</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the record is not found, the GNSS secure transceiver returns ‘6A83’.</div>
               </div>
            </div>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>— </span>
               </div>
               <div class="grid-list-column-2">
                  <div class="list">If the external GNSS facility has detected tampering, it shall return status words ‘6690’.</div>
               </div>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: DELETED">▼M3</a> —————</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<p class="title-gr-seq-level-4" id="id-488d7801-f1ba-4bf5-b1b3-fefe78ba85c9">4.2.4   <span class="boldface">
                  <span class="boldface">Structure of the WriteRecord command</span>
               </span>
            </p>
<p class="norm">This section describes in detail the structure of the Write Record command. Secure messaging (authentication-only mode) is added as described in Appendix 11 Common security mechanisms.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_26a</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">The command shall support the Secure Messaging authentication-only-mode, see Appendix 11.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_26b</p>
                  </td>
                  <td valign="top">
                     <p class="norm">Command Message</p>
                     <p>
                        <br/>
                     </p>
                     <div class="centered">
                        <p>
                           <br/>
                        </p>
                        <table width="240" border="1" cellpadding="2" cellspacing="0">
                           <colgroup><col width="5%"/>
                           <col width="7%"/>
                           <col width="23%"/>
                           <col width="65%"/>
                           </colgroup><tbody>
                              <tr>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Byte</p>
                                 </td>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Length</p>
                                 </td>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Value</p>
                                 </td>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Description</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">CLA</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">1</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">‘0Ch’</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Secure messaging asked.</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">INS</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">1</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">‘D2h’</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Write Record</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">P1</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">1</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">‘XXh’</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Record number (&#39;00&#39; references the current record)</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">P2</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">1</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">‘04h’</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Write the record with the record number indicated in P1</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">Data</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">X</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">‘XXh’</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Data</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_26c</p>
                  </td>
                  <td valign="top">
                     <p class="norm">The record referenced in P1 becomes the current record.</p>
                     <p>
                        <br/>
                     </p>
                     <div class="centered">
                        <p>
                           <br/>
                        </p>
                        <table width="240" border="1" cellpadding="2" cellspacing="0">
                           <colgroup><col width="8%"/>
                           <col width="11%"/>
                           <col width="40%"/>
                           <col width="42%"/>
                           </colgroup><tbody>
                              <tr>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Byte</p>
                                 </td>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Length</p>
                                 </td>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Value</p>
                                 </td>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Description</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">SW</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">2</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">‘XXXXh’</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Status Words (SW1,SW2)</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">If the command is successful, the GNSS secure transceiver returns ‘
                                                   <span class="boldface">9000</span>
                                                   ’.</div>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">If the current file is not record oriented, the GNSS secure transceiver returns <span class="boldface">&#39;6981&#39;</span>.</div>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">If the command is used with P1 = &#39;00&#39; but there is no current EF the GNSS secure transceiver returns <span class="boldface">&#39;6986&#39;</span> (command not allowed).</div>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">If the record is not found, the GNSS secure transceiver returns <span class="boldface">&#39;6A83&#39;</span>.</div>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">If the external GNSS facility has detected tampering, it shall return status words <span class="boldface">
                                                      ‘6690’
                                                   </span>.</div>
                        </div>
                     </div>
                  </td>
               </tr>
            </tbody></table>
<p class="title-gr-seq-level-4" id="id-b3c875e4-a12d-4e83-8f18-364ce09b3b2d">4.2.5   <span class="boldface">Other commands</span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_27</p>
                  </td>
                  <td valign="top">
                     <p class="norm">The GNSS Secure Transceiver shall support the following tachograph generation 2 commands specified in Appendix 2:</p>
                     <p>
                        <br/>
                     </p>
                     <div class="centered">
                        <p>
                           <br/>
                        </p>
                        <table width="240" border="1" cellpadding="2" cellspacing="0">
                           <colgroup><col width="44%"/>
                           <col width="56%"/>
                           </colgroup><tbody>
                              <tr>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Command</p>
                                 </td>
                                 <td style="font-weight: bold" valign="top">
                                    <p class="tbl-norm">Reference</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">Select</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Appendix 2 chapter 3.5.1</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">Read Binary</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Appendix 2 chapter 3.5.2</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">Get Challenge</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Appendix 2 chapter 3.5.4</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">PSO: Verify Certificate</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Appendix 2 chapter 3.5.7</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">External Authenticate</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Appendix 2 chapter 3.5.9</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">General Authenticate</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Appendix 2 chapter 3.5.10</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">MSE:SET</p>
                                 </td>
                                 <td valign="top">
                                    <p class="tbl-norm">Appendix 2 chapter 3.5.11</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-3" id="id-90896009-751a-4590-b1de-4f045c97287b">4.3.   <span class="boldface">
                  <span class="boldface">Coupling, mutual authentication and session key agreement of the external GNSS facility with vehicle unit</span>
               </span>
            </p>
<p class="norm">The coupling, mutual authentication and session key agreement of the external GNSS facility with the vehicle unit is described in Appendix 11. Common security mechanisms, Chapter 11.</p>
<p class="title-gr-seq-level-3" id="id-88c5a51e-18ab-4fe9-a06c-3fdad4a6dec3">4.4.   <span class="boldface">
                  <span class="boldface">Error Handling</span>
               </span>
            </p>
<p class="norm">This section describes how potential error conditions by the external GNSS facility are addressed and recorded in the VU.</p>
<p class="title-gr-seq-level-4" id="id-a6f0ac26-017d-4a31-aacc-b7d961f80ea5">4.4.1   <span class="boldface">
                  <span class="italics">Communication error with the external GNSS facility</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_28<span style="word-spacing: NaNpt"> </span>A communication error with the external GNSS facility event shall be recorded in the VU, as defined in requirement 82 of Annex IC and Appendix 1 (EventFaultType). In this context, a communication error is triggered when the VU Secure Transceiver does not receive a response message after a request message as described in 4.2.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-2830746b-6014-496b-8b76-540de8e63fbd">4.4.2   <span class="boldface">
                  <span class="italics">Breach of the physical integrity of the external GNSS facility</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_29<span style="word-spacing: NaNpt"> </span>If the external GNSS facility has been breached, the GNSS Secure Transceiver shall ensure that cryptographic material is unavailable. As described in GNS_25 and GNS_26, the VU shall detect tampering if the Response has status ‘6690’. The VU shall then generate and record a security breach attempt event as defined in requirement 85 of Annex IC and Appendix 1 (EventFaultType for tamper detection of GNSS). Alternately, the external GNSS facility may respond to VU requests without secure messaging and with status ‘6A88’.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-d5192376-87c1-4db0-8932-ffbe5f9602fb">4.4.3   <span class="boldface">
                  <span class="italics">Absence of position information from GNSS receiver</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_30<span style="word-spacing: NaNpt"> </span>If the GNSS Secure Transceiver does not receive data from the GNSS receiver, the GNSS Secure Transceiver shall generate a response message to the READ RECORD command with RECORD number equal to ‘01’ with a Data Field of 12 bytes all set to 0xFF. Upon reception of the Response message with this value of the data field, the VU shall generate and record an absence of position information from GNSS receiver event, as defined in requirement 81 of Annex IC and Appendix 1 (EventFaultType).</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-4" id="id-73a13fa5-2741-42e6-afbd-25a592aa8f37">4.4.4   <span class="boldface">
                  <span class="italics">External GNSS facility certificate expired</span>
               </span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_31<span style="word-spacing: NaNpt"> </span>If the VU detects that the EGF certificate used for mutual authentication is not valid any longer, the VU shall generate and record a security breach attempt event as defined in requirement 85 of Annex IC and Appendix 1 (EventFaultType for external GNSS facility certificate expired). The VU shall still use the received GNSS position data.</p>
            </div>
<p class="title-gr-seq-level-5" id="id-89cf64cc-0054-44e8-91fe-386edcb4c344">
               <span class="italics">Figure 6</span>
            </p>
<p class="title-gr-seq-level-5" id="id-5244c347-a12f-4262-a3b6-6fb63a4d4d7b">
               <span class="boldface">Schema of the external GNSS facility</span>
            </p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<p class="title-gr-seq-level-2" id="id-7639a3d3-ddb7-4cda-a298-c66cbc6139e9">5.   <span class="boldface">VEHICLE UNIT WITHOUT AN EXTERNAL GNSS FACILITY</span>
            </p>
<p class="title-gr-seq-level-3" id="id-c38a40c7-6f7b-4d65-9251-6cda2b3d7fbc">5.1.   <span class="boldface">
                  <span class="boldface">Configuration</span>
               </span>
            </p>
<p class="norm">In this configuration, the GNSS receiver is inside the Vehicle Unit as described in Figure 1.</p>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_32<span style="word-spacing: NaNpt"> </span>For transmitting position, DOP and satellites data, the GNSS receiver shall act as a talker and transmit NMEA or NMEA-like sentences to the VU processor, which shall act as a listener with a frequency of 1/10 Hz or faster for the pre-defined set of sentences, which shall include at least the RMC, GSA, AMC and ASA sentences. Alternatively, the VU processor and the internal GNSS receiver may use other data formats to exchange the data contained in the NMEA or NMEA-like sentences specified in GNS_4, GNS_4a and GNS_5.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32016R0799" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32016R0799">▼B</a>
            </p>
<div style="margin-left: 48pt; text-indent: -48pt">
               <p class="norm">GNS_33<span style="word-spacing: NaNpt"> </span>An external GNSS antenna installed on the vehicle or an internal GNSS antenna shall be connected to the VU.</p>
            </div>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: REPLACED">▼M3</a>
            </p>
<p class="title-gr-seq-level-3" id="id-2bfaa93b-067f-4b1c-8e03-e90932bea62d">5.2.   <span class="boldface">
                  <span class="boldface">Transfer of information from the GNSS receiver to the VU</span>
               </span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_34</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">The VU processor checks the received data extracting the information (e.g., latitude, longitude, time) from the RMC NMEA sentence and the AMC sentence.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_35</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">The RMC NMEA sentence includes the information if the non-authenticated position is valid. If the non-authenticated position is not valid, the position data is not available and it cannot be used to record the position of the vehicle. If the non-authenticated position is valid, the VU processor also extracts the values of HDOP from GSA NMEA.</p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_36</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">The VU processor also extracts the information (e.g. latitude, longitude, time) from the AMC sentence. The AMC sentence includes the information if the non-authenticated position is valid according to GNS_4a. If the non-authenticated position is valid, the VU processor also extracts the values of HDOP from ASA sentences.</p>
                  </td>
               </tr>
            </tbody></table>
<p class="title-gr-seq-level-3" id="id-30802b4b-25ec-4b30-8664-2276cc098f12">5.3.   <span class="boldface">
                  <span class="boldface">Transfer of information from the VU to the GNSS receiver</span>
               </span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_37</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">The VU processor provides to the GNSS receiver the VU RTC time and the maximal difference between true time and the VU RTC time, in accordance with GNS_3f and GNS_3g.</p>
                  </td>
               </tr>
            </tbody></table>
<p class="title-gr-seq-level-3" id="id-4625aec9-a608-40e8-a1ca-2ed683df2859">5.4.   <span class="boldface">
                  <span class="boldface">Error handling</span>
               </span>
            </p>
<div class="grid-container grid-list">
               <div class="list grid-list-column-1">
                  <span>5.4.1 </span>
               </div>
               <div class="grid-list-column-2">
                  <p class="norm">Absence of position information from GNSS receiver</p>
                  <table width="100%" border="0" cellspacing="0" cellpadding="0">
                     <colgroup><col width="10%"/>
                     <col width="90%"/>
                     </colgroup><tbody><tr>
                        <td valign="top">
                           <p class="dlist-term">GNS_38</p>
                        </td>
                        <td valign="top">
                           <p class="dlist-definition">The VU shall generate and record an absence of position information from GNSS receiver event, as defined in requirement 81 of Annex IC and Appendix 1 (EventFaultType).</p>
                        </td>
                     </tr>
                  </tbody></table>
               </div>
            </div>
<p class="title-gr-seq-level-2" id="id-4ad409cf-8163-465d-a985-38c64b0262a6">6.   <span class="boldface">POSITION DATA PROCESSING AND RECORDING BY THE VU</span>
            </p>
<p class="norm">This section is valid both for the configuration of the Smart Tachograph with or without an external GNSS facility.</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_39</p>
                  </td>
                  <td valign="top">
                     <p class="norm">Position data shall be stored in the VU, together with a flag indicating if the position has been authenticated. When position data need to be recorded in the VU, the following rules shall apply:</p>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>(a) </span>
                        </div>
                        <div class="grid-list-column-2">
                           <p class="norm">If both authenticated and standard positions are valid and consistent, the standard position and its accuracy shall be recorded in the VU and the flag shall be set to ‘authenticated’.</p>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>(b) </span>
                        </div>
                        <div class="grid-list-column-2">
                           <p class="norm">If both authenticated and standard positions are valid but not consistent, the VU shall store the authenticated position and its accuracy, and the flag shall be set to ‘authenticated’.</p>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>(c) </span>
                        </div>
                        <div class="grid-list-column-2">
                           <p class="norm">If the authenticated position is valid and the standard position is not valid, the VU shall record the authenticated position and its accuracy, and the flag shall be set to ‘authenticated’.</p>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>(d) </span>
                        </div>
                        <div class="grid-list-column-2">
                           <p class="norm">If the standard position is valid and the authenticated position is not valid, the VU shall record the standard position and its accuracy, and the flag shall be set to ‘not authenticated’.</p>
                        </div>
                     </div>
                     <p class="norm">Authenticated and standard positions are considered as consistent, as shown in Figure 7, when the horizontal authenticated position can be found in a circle centered at the horizontal standard position, which radius results of rounding up to the nearest upper whole number the value of R_H calculated according to the following formula:</p>
                     <p>
                        <br/>
                     </p>
                     <div class="centered">
                        <p>
                           <br/>
                        </p>
                        <table width="240" border="1" cellpadding="2" cellspacing="0">
                           <colgroup><col width="100%"/>
                           </colgroup><tbody>
                              <tr>
                                 <td valign="top">
                                    <p class="tbl-norm">R_H = 1.74 • σ<span class="subscript">UERE</span> • HDOP</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <p class="norm">where:</p>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">R_H is the relative radius of a circle around the estimated horizontal position, in meters. It is an indicator that is used to check consistency between standard and authenticated positions.</div>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">σ<span class="subscript">UERE</span> is the standard deviation for the user equivalent range error (UERE), which models all measurement errors for the target application, including urban environments. A constant value of σ<span class="subscript">UERE</span> = 10 meters shall be used.</div>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">HDOP is the horizontal dilution of precision calculated by the GNSS receiver.</div>
                        </div>
                     </div>
                     <div class="grid-container grid-list">
                        <div class="list grid-list-column-1">
                           <span>— </span>
                        </div>
                        <div class="grid-list-column-2">
                           <div class="list">σ<span class="subscript">UERE</span> . HDOP is the estimation of the root mean squared error in the horizontal domain.</div>
                        </div>
                     </div>
                     <p class="norm">
                         
                        <span class="italics">Figure 7</span> 
                        <br/> 
                        <span class="boldface">Consistent Authenticated and Standard (non-authenticated) positions</span> 
                     </p>
                  </td>
               </tr>
            </tbody></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_40</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">When the value of the Status in a received AMC sentence is set to ‘J’ or ‘O’ or ‘F’ in accordance with requirement GNS_4a, the VU shall generate and record a GNSS anomaly event, as defined in requirement 88a of Annex IC and Appendix 1 (EventFaultType). The vehicle unit may perform additional checks before storing a GNSS anomaly event following the reception of a ‘J’ or ‘O’ setting.</p>
                  </td>
               </tr>
            </tbody></table>
<p class="title-gr-seq-level-2" id="id-38d59d34-4e14-4b39-b7d0-3e7cc903709a">7.   <span class="boldface">GNSS TIME CONFLICT</span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_41</p>
                  </td>
                  <td valign="top">
                     <p class="dlist-definition">If the VU detects a discrepancy between the time of the vehicle unit’s time measurement function and the time originating from the GNSS signals, it shall generate and record a time conflict event, as defined in requirement 86 of Annex IC and Appendix 1 (EventFaultType).</p>
                  </td>
               </tr>
            </tbody></table>
<p class="modref">
               <a href="http://publications.europa.eu/resource/celex/32021R1228" onclick="window.open(this.href,&#39;_blank&#39;); return false;" title="32021R1228: INSERTED">▼M3</a>
            </p>
<p class="title-gr-seq-level-2" id="id-c8b7de57-7612-4190-8a5f-bb00003da785">8.   <span class="boldface">VEHICLE MOTION CONFLICT</span>
            </p>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
               <colgroup><col width="10%"/>
               <col width="90%"/>
               </colgroup><tbody><tr>
                  <td valign="top">
                     <p class="dlist-term">GNS_42</p>
                  </td>
                  <td valign="top">
                     <p class="norm">The VU shall trigger and record a Vehicle Motion Conflict event in accordance with requirement 84 of Annex IC, in case motion information calculated from the motion sensor is contradicted by motion information calculated from the internal GNSS receiver, from the external GNSS facility, or by other independent motion source(s) as set out in requirement 26 of Annex IC.</p>
                     <p class="norm">The vehicle motion conflict event shall be triggered upon occurrence of one of the following trigger conditions:</p>
                     <div class="list">
                        <span class="underline">Trigger condition 1:</span>
                     </div>
                     <div class="list">The trimmed mean value of the speed differences between these sources shall be used, when the position information from the GNSS receiver is available and when the ignition of the vehicle is switched on, as specified below:</div>
                     <div class="list">
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">every 10 seconds maximum, the absolute value of the difference between the vehicle speed estimated from the GNSS and the one estimated from the motion sensor shall be computed.</div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">all the computed values in a time window containing the last 5 minutes of vehicle movement shall be used to compute the trimmed mean value.</div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">the trimmed mean value shall be computed as the average of 80% of the remaining values, after having eliminated the highest ones in absolute values.</div>
                           </div>
                        </div>
                     </div>
                     <div class="list">The Vehicle Motion Conflict event shall be triggered if the trimmed mean value is above 10 km/h for five uninterrupted minutes of vehicle movement. (Note: the use of the trimmed mean on the last 5 minutes is applied to mitigate the risk of measurement outliers and transient values).</div>
                     <div class="list">For the trimmed mean computation, the vehicle shall be considered as moving if at least one vehicle speed value estimated either from motion sensor or from GNSS receiver is not equal to zero.</div>
                     <div class="list">
                        <span class="underline">Trigger condition 2:</span>
                     </div>
                     <div class="list">The vehicle motion conflict event shall also be triggered if the following condition is true:</div>
                     <div class="list">
                        <span class="italics">GnssDistance</span>&gt;[<span class="italics">OdometerDifference</span>×<span class="italics">OdometerToleranceFactor</span>+<span class="italics">Minimum</span>(<span class="italics">SlipDistanceUpperlimit</span>;(<span class="italics">OdometerDifference</span>×<span class="italics">SlipFactor</span>))+<span class="italics">GnssTolerance</span>+<span class="italics">FerryTrainDistance</span>]</div>
                     <div class="list">where:</div>
                     <div class="list">
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">
                                 <span class="italics">GnssDistance</span> is the distance between the current position of the vehicle and the previous one, both obtained from valid authenticated position messages, without considering the height,</div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">OdometerDifference is the difference between the current odometer value and the odometer value corresponding to the previous valid authenticated position message,</div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">OdometerToleranceFactor is equal to 1.1 (worst case tolerance factor for all measurement tolerances of the vehicle odometer),</div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">GnssTolerance is equal to 1 km (worst case GNSS tolerance),</div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">Minimum (SlipDistanceUpperLimit; (OdometerDifference * SlipFactor)) is the minimum value between:</div>
                              <div class="list">
                                 <div class="grid-container grid-list">
                                    <div class="list grid-list-column-1">
                                       <span>— </span>
                                    </div>
                                    <div class="grid-list-column-2">
                                       <div class="list">SlipDistanceUpperLimit which is equal to 10 km (upper limit of the slip distance caused by slipping effects during braking),</div>
                                    </div>
                                 </div>
                                 <div class="grid-container grid-list">
                                    <div class="list grid-list-column-1">
                                       <span>— </span>
                                    </div>
                                    <div class="grid-list-column-2">
                                       <div class="list">and OdometerDifference * SlipFactor, in which SlipFactor is equal to 0.2 (maximal influence of slipping effects during breaking),</div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">FerryTrainDistance is computed as: FerryTrainDistance =200km/h * tFerryTrain, where tFerryTrain is the sum of the durations in hours of the ferry/train crossings in the considered time interval. The duration of a ferry/train crossings is defined as the time difference between its end flag and its beginning flag.</div>
                           </div>
                        </div>
                     </div>
                     <div class="list">The preceding verifications shall be performed every 15 minutes if the necessary position data are available, otherwise as soon as the position data are available.</div>
                     <div class="list">For this trigger condition:</div>
                     <div class="list">
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">date and time of beginning of event shall be equal to the date and time when the previous position message was received,</div>
                           </div>
                        </div>
                        <div class="grid-container grid-list">
                           <div class="list grid-list-column-1">
                              <span>— </span>
                           </div>
                           <div class="grid-list-column-2">
                              <div class="list">date and time of end of event shall be equal to the date and time when the checked condition becomes false again.</div>
                           </div>
                        </div>
                     </div>
                     <div class="list">
                        <span class="underline">Trigger condition 3:</span>
                     </div>
                     <div class="list">The vehicle unit encounters a discrepancy consisting of the motion sensor not detecting any movement and the independent motion source detecting movement for a specific period. The conditions to record a discrepancy as well as the period of detection of the discrepancy shall be set out by the vehicle unit manufacturer, although the discrepancy shall be detected in no more than three hours.</div>
                  </td>
               </tr>
            </tbody></table>
</body>
</html>